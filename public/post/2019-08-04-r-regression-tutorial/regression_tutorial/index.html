<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.3.1">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Jan Kirenz">

  
  
  
    
  
  <meta name="description" content="Berechnung von einfachen Statistiken in R.">

  
  <link rel="alternate" hreflang="en-us" href="/post/2019-08-04-r-regression-tutorial/regression_tutorial/">

  


  

  
  
  
  <meta name="theme-color" content="#E13D3D">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/paraiso-light.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/paraiso-light.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    

    

  

  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Arapey:400,400i|Karla:400,700|Roboto+Mono|Open Sans:300">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.1322fc49e20b88c93e5b9cdb13456289.css">

  
    
    
    
    
      
    
    
    
    <link rel="stylesheet" href="/css/academic.8fa6fab8892f3fb614ebe2b828140a5f.css">
  

  
  
  

  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/2019-08-04-r-regression-tutorial/regression_tutorial/">

  
  
  
  
    
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="Jan Kirenz">
  <meta property="og:url" content="/post/2019-08-04-r-regression-tutorial/regression_tutorial/">
  <meta property="og:title" content="Regression Tutorial in Python | Jan Kirenz">
  <meta property="og:description" content="Berechnung von einfachen Statistiken in R."><meta property="og:image" content="/img/avatar.jpg">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2019-08-04T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2019-08-04T00:00:00&#43;00:00">
  

  

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
<script>
  window.addEventListener("load", function(){
    window.cookieconsent.initialise({
      "palette": {
        "popup": {
          "background": "#E13D3D",
          "text": "#ffffff"
        },
        "button": {
          "background": "#ffffff",
          "text": "#E13D3D"
        }
      },
      "theme": "classic",
      "content": {
        "message": "This website uses cookies to ensure you get the best experience on our website.",
        "dismiss": "Got it!",
        "link": "Learn more",
        "href": "https://cookies.insites.com"
      }
    })});
</script>



  





  <title>Regression Tutorial in Python | Jan Kirenz</title>

</head>


<body id="top" data-spy="scroll" data-target="#TableOfContents" data-offset="71" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" role="textbox" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">Jan Kirenz</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/post"><span>Blog</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/talks"><span>Teaching</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/projects"><span>Resources</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/contact"><span>Contact</span></a>
        </li>

        
        

      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article" itemscope itemtype="http://schema.org/Article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1 itemprop="name">Regression Tutorial in Python</h1>

  

  
    



<meta content="2019-08-04 00:00:00 &#43;0000 UTC" itemprop="datePublished">
<meta content="2019-08-04 00:00:00 &#43;0000 UTC" itemprop="dateModified">

<div class="article-metadata">

  
  
  
  
  <div>
    



  <span itemprop="author name" itemtype="http://schema.org/Person"><a href="/authors/jan/">Jan Kirenz</a></span>

  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    <time>Aug 4, 2019</time>
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    38 min read
  </span>
  

  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder"></i>
    <a href="/categories/appliedstatistics/">AppliedStatistics</a>, <a href="/categories/python/">Python</a>, <a href="/categories/german/">German</a></span>
  

  
    
<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/post/2019-08-04-r-regression-tutorial/regression_tutorial/&amp;text=Regression%20Tutorial%20in%20Python" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/post/2019-08-04-r-regression-tutorial/regression_tutorial/&amp;t=Regression%20Tutorial%20in%20Python" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Regression%20Tutorial%20in%20Python&amp;body=/post/2019-08-04-r-regression-tutorial/regression_tutorial/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/post/2019-08-04-r-regression-tutorial/regression_tutorial/&amp;title=Regression%20Tutorial%20in%20Python" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Regression%20Tutorial%20in%20Python%20/post/2019-08-04-r-regression-tutorial/regression_tutorial/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/post/2019-08-04-r-regression-tutorial/regression_tutorial/&amp;title=Regression%20Tutorial%20in%20Python" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>


  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      

<p><strong>Applied Statistics</strong><br/>
Prof. Dr. Jan Kirenz <br/>
Hochschule der Medien Stuttgart</p>

<p><h1>Table of Contents<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#Import-data" data-toc-modified-id="Import-data-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>Import data</a></span></li><li><span><a href="#Tidying-data" data-toc-modified-id="Tidying-data-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>Tidying data</a></span><ul class="toc-item"><li><span><a href="#Data-inspection" data-toc-modified-id="Data-inspection-2.1"><span class="toc-item-num">2.1&nbsp;&nbsp;</span>Data inspection</a></span></li><li><span><a href="#Handle-missing-values" data-toc-modified-id="Handle-missing-values-2.2"><span class="toc-item-num">2.2&nbsp;&nbsp;</span>Handle missing values</a></span></li></ul></li><li><span><a href="#Transform-data" data-toc-modified-id="Transform-data-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>Transform data</a></span><ul class="toc-item"><li><span><a href="#Descriptive-statistics" data-toc-modified-id="Descriptive-statistics-3.1"><span class="toc-item-num">3.1&nbsp;&nbsp;</span>Descriptive statistics</a></span><ul class="toc-item"><li><span><a href="#Measures-of-central-tendency" data-toc-modified-id="Measures-of-central-tendency-3.1.1"><span class="toc-item-num">3.1.1&nbsp;&nbsp;</span>Measures of central tendency</a></span></li><li><span><a href="#Measures-of-dispersion" data-toc-modified-id="Measures-of-dispersion-3.1.2"><span class="toc-item-num">3.1.2&nbsp;&nbsp;</span>Measures of dispersion</a></span></li><li><span><a href="#Summary-statistics" data-toc-modified-id="Summary-statistics-3.1.3"><span class="toc-item-num">3.1.3&nbsp;&nbsp;</span>Summary statistics</a></span></li></ul></li></ul></li><li><span><a href="#Visualize-data" data-toc-modified-id="Visualize-data-4"><span class="toc-item-num">4&nbsp;&nbsp;</span>Visualize data</a></span><ul class="toc-item"><li><span><a href="#Distibution-of-Variables" data-toc-modified-id="Distibution-of-Variables-4.1"><span class="toc-item-num">4.1&nbsp;&nbsp;</span>Distibution of Variables</a></span></li><li><span><a href="#Relationship-between-variables" data-toc-modified-id="Relationship-between-variables-4.2"><span class="toc-item-num">4.2&nbsp;&nbsp;</span>Relationship between variables</a></span></li></ul></li><li><span><a href="#Model" data-toc-modified-id="Model-5"><span class="toc-item-num">5&nbsp;&nbsp;</span>Model</a></span><ul class="toc-item"><li><span><a href="#Model-1:-Mean" data-toc-modified-id="Model-1:-Mean-5.1"><span class="toc-item-num">5.1&nbsp;&nbsp;</span>Model 1: Mean</a></span></li><li><span><a href="#Model-2:-Linear-Regression" data-toc-modified-id="Model-2:-Linear-Regression-5.2"><span class="toc-item-num">5.2&nbsp;&nbsp;</span>Model 2: Linear Regression</a></span></li></ul></li><li><span><a href="#Measuring-the-quality-of-fit:-errors" data-toc-modified-id="Measuring-the-quality-of-fit:-errors-6"><span class="toc-item-num">6&nbsp;&nbsp;</span>Measuring the quality of fit: errors</a></span><ul class="toc-item"><li><span><a href="#Sum-of-squared-errors-and-$R^2$" data-toc-modified-id="Sum-of-squared-errors-and-$R^2$-6.1"><span class="toc-item-num">6.1&nbsp;&nbsp;</span>Sum of squared errors and $R^2$</a></span><ul class="toc-item"><li><span><a href="#Model-1:-Mean" data-toc-modified-id="Model-1:-Mean-6.1.1"><span class="toc-item-num">6.1.1&nbsp;&nbsp;</span>Model 1: Mean</a></span></li><li><span><a href="#Model-2:-Linear-Regression" data-toc-modified-id="Model-2:-Linear-Regression-6.1.2"><span class="toc-item-num">6.1.2&nbsp;&nbsp;</span>Model 2: Linear Regression</a></span></li></ul></li><li><span><a href="#Pearson's-correlation-coefficient" data-toc-modified-id="Pearson's-correlation-coefficient-6.2"><span class="toc-item-num">6.2&nbsp;&nbsp;</span>Pearson&rsquo;s correlation coefficient</a></span><ul class="toc-item"><li><span><a href="#Model-2:-Linear-Regression" data-toc-modified-id="Model-2:-Linear-Regression-6.2.1"><span class="toc-item-num">6.2.1&nbsp;&nbsp;</span>Model 2: Linear Regression</a></span></li></ul></li><li><span><a href="#Mean-squared-error,-variance-and-standard-deviation" data-toc-modified-id="Mean-squared-error,-variance-and-standard-deviation-6.3"><span class="toc-item-num">6.3&nbsp;&nbsp;</span>Mean squared error, variance and standard deviation</a></span><ul class="toc-item"><li><span><a href="#Model-1:-Mean" data-toc-modified-id="Model-1:-Mean-6.3.1"><span class="toc-item-num">6.3.1&nbsp;&nbsp;</span>Model 1: Mean</a></span></li><li><span><a href="#Model-2:-Linear-Regression" data-toc-modified-id="Model-2:-Linear-Regression-6.3.2"><span class="toc-item-num">6.3.2&nbsp;&nbsp;</span>Model 2: Linear Regression</a></span></li></ul></li><li><span><a href="#F-Statistic" data-toc-modified-id="F-Statistic-6.4"><span class="toc-item-num">6.4&nbsp;&nbsp;</span>F-Statistic</a></span><ul class="toc-item"><li><span><a href="#Model-2:-Linear-Regression" data-toc-modified-id="Model-2:-Linear-Regression-6.4.1"><span class="toc-item-num">6.4.1&nbsp;&nbsp;</span>Model 2: Linear Regression</a></span></li></ul></li><li><span><a href="#5.2.5-Standard-error" data-toc-modified-id="5.2.5-Standard-error-6.5"><span class="toc-item-num">6.5&nbsp;&nbsp;</span>5.2.5 Standard error</a></span><ul class="toc-item"><li><span><a href="#Model-1:-Mean" data-toc-modified-id="Model-1:-Mean-6.5.1"><span class="toc-item-num">6.5.1&nbsp;&nbsp;</span>Model 1: Mean</a></span></li><li><span><a href="#Model-2:-Linear-Regression" data-toc-modified-id="Model-2:-Linear-Regression-6.5.2"><span class="toc-item-num">6.5.2&nbsp;&nbsp;</span>Model 2: Linear Regression</a></span></li></ul></li><li><span><a href="#Confidence-interval" data-toc-modified-id="Confidence-interval-6.6"><span class="toc-item-num">6.6&nbsp;&nbsp;</span>Confidence interval</a></span><ul class="toc-item"><li><span><a href="#Model-1:-The-Mean" data-toc-modified-id="Model-1:-The-Mean-6.6.1"><span class="toc-item-num">6.6.1&nbsp;&nbsp;</span>Model 1: The Mean</a></span></li><li><span><a href="#Model-2:-Linear-Regression" data-toc-modified-id="Model-2:-Linear-Regression-6.6.2"><span class="toc-item-num">6.6.2&nbsp;&nbsp;</span>Model 2: Linear Regression</a></span></li></ul></li><li><span><a href="#Confidence-intervals-in-small-samples" data-toc-modified-id="Confidence-intervals-in-small-samples-6.7"><span class="toc-item-num">6.7&nbsp;&nbsp;</span>Confidence intervals in small samples</a></span></li></ul></li><li><span><a href="#Further-measures-for-model-selection" data-toc-modified-id="Further-measures-for-model-selection-7"><span class="toc-item-num">7&nbsp;&nbsp;</span>Further measures for model selection</a></span><ul class="toc-item"><li><span><a href="#Bayesian-information-criterion-(BIC)" data-toc-modified-id="Bayesian-information-criterion-(BIC)-7.1"><span class="toc-item-num">7.1&nbsp;&nbsp;</span>Bayesian information criterion (BIC)</a></span></li><li><span><a href="#Akaike-information-criterion-(AIC)" data-toc-modified-id="Akaike-information-criterion-(AIC)-7.2"><span class="toc-item-num">7.2&nbsp;&nbsp;</span>Akaike information criterion (AIC)</a></span></li></ul></li></ul></div></p>

<pre><code class="language-python"># Python set up (load modules)
import numpy as np
import pandas as pd
from pandas.api.types import CategoricalDtype
from scipy import stats
import statsmodels.api as sm
import statsmodels.formula.api as smf
from statsmodels.stats.outliers_influence import summary_table # confidence intervall
import matplotlib.pyplot as plt
%matplotlib inline
plt.style.use('ggplot')
import seaborn as sns  
sns.set()
from IPython.display import Image
</code></pre>

<h1 id="linear-regression-and-the-quality-of-fit">Linear regression and the quality of fit</h1>

<p>In this application we cover linear regression - the fundamental starting point for all regression methods - and how to evaluate the quality of fit of a regression model. Therefore, we quantify the extent to which the predicted outcome value for a given observation is close to the true outcome value for that observation. In the regression setting, the most commonly-used measure is the mean squared error (MSE), which we will cover in detail.</p>

<p>One of the simplest models we use in statistics is the <strong>mean</strong>. It is a (simple) model because it represents a summary of data. Therefore, we use the mean as a baseline model and compare the quality of fit between the mean and a simple linear regression model with only one predictor. In our application, we use a sample of 20 adult german women from whom we obtained their height and the average height of their parents (height_parents).</p>

<p>Data description (n = 20, p = 5); Variables: name, unique identification number (id), height, average height of parents (height_parents), gender.</p>

<hr />

<p><em>Source</em></p>

<p><em>The statistical explanations in this tutorial are mainly based on Field (2018).</em></p>

<p>Field, A. (2018). Discovering statistics using IBM SPSS statistics. Thousand Oaks, CA.</p>

<hr />

<h2 id="import-data">Import data</h2>

<pre><code class="language-python"># Instead of importing data, we will create our own data
df = pd.DataFrame({ 'name': pd.Categorical([ &quot;Stefanie&quot;, &quot;Petra&quot;, &quot;Stefanie&quot;,
                                             &quot;Manuela&quot;, &quot;Nadine&quot;, &quot;Sophia&quot;,  
                                             &quot;Ellen&quot;, &quot;Emilia&quot;, &quot;Lina&quot;,
                                             &quot;Marie&quot;, &quot;Lena&quot;, &quot;Mila&quot;,    
                                             &quot;Ida&quot;, &quot;Ella&quot;, &quot;Pia&quot;,
                                             &quot;Sarah &quot;, &quot;Lia&quot;, &quot;Lotta&quot;,
                                             &quot;Emma&quot;, &quot;Lina&quot;]),
                       'id': pd.Categorical([&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;,  
                                             &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;10&quot;, &quot;11&quot;, &quot;12&quot;,    
                                             &quot;13&quot;, &quot;14&quot;, &quot;15&quot;, &quot;16 &quot;, &quot;17&quot;, &quot;18&quot;,
                                             &quot;19&quot;, &quot;20&quot;]),
                          'height': np.array([162, 163, 163, 164, 164, 164, 164, 165,
                                              165, 165, 165, 165, 165, 166, 166, 166,
                                              166, 167, 167, 168],dtype='int32'),
                  'height_parents': np.array([161, 163, 163, 165, 163, 164, 164, 165,
                                              165, 165, 166, 167, 165, 166, 166, 166,
                                              166, 166, 167, 168],dtype='int32'),
                                    'gender': 'female' })
</code></pre>

<h2 id="tidying-data">Tidying data</h2>

<h3 id="data-inspection">Data inspection</h3>

<p>First of all, let&rsquo;s take a look at the variables (columns) in the data set.</p>

<pre><code class="language-python"># show all variables in the data set
df.columns
</code></pre>

<pre><code>Index(['name', 'id', 'height', 'height_parents', 'gender'], dtype='object')
</code></pre>

<pre><code class="language-python"># show the first 5 rows (i.e. head of the DataFrame)
df.head(10)
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>id</th>
      <th>height</th>
      <th>height_parents</th>
      <th>gender</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Stefanie</td>
      <td>1</td>
      <td>162</td>
      <td>161</td>
      <td>female</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Petra</td>
      <td>2</td>
      <td>163</td>
      <td>163</td>
      <td>female</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Stefanie</td>
      <td>3</td>
      <td>163</td>
      <td>163</td>
      <td>female</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Manuela</td>
      <td>4</td>
      <td>164</td>
      <td>165</td>
      <td>female</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Nadine</td>
      <td>5</td>
      <td>164</td>
      <td>163</td>
      <td>female</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Sophia</td>
      <td>6</td>
      <td>164</td>
      <td>164</td>
      <td>female</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Ellen</td>
      <td>7</td>
      <td>164</td>
      <td>164</td>
      <td>female</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Emilia</td>
      <td>8</td>
      <td>165</td>
      <td>165</td>
      <td>female</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Lina</td>
      <td>9</td>
      <td>165</td>
      <td>165</td>
      <td>female</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Marie</td>
      <td>10</td>
      <td>165</td>
      <td>165</td>
      <td>female</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># show the lenght of the variable id (i.e. the number of observations)
len(df[&quot;id&quot;])
</code></pre>

<pre><code>20
</code></pre>

<pre><code class="language-python"># check for duplicates and print results (if the two numbers match, we have no duplicates)
# show the lenght of the variable id (i.e. the number of observations)
print(f'IDs: {len(df[&quot;id&quot;])}')
# count the number of individual id's
print(f'Unique IDs: {len(df[&quot;id&quot;].value_counts())}')
</code></pre>

<pre><code>IDs: 20
Unique IDs: 20
</code></pre>

<pre><code class="language-python"># we don't need the variable gender
df = df.drop('gender', axis=1)
</code></pre>

<pre><code class="language-python"># data overview (with meta data)
df.info()
</code></pre>

<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 20 entries, 0 to 19
Data columns (total 4 columns):
name              20 non-null category
id                20 non-null category
height            20 non-null int32
height_parents    20 non-null int32
dtypes: category(2), int32(2)
memory usage: 1.8 KB
</code></pre>

<pre><code class="language-python"># show the first 20 rows (i.e. head of the DataFrame)
df.head(20)
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>id</th>
      <th>height</th>
      <th>height_parents</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Stefanie</td>
      <td>1</td>
      <td>162</td>
      <td>161</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Petra</td>
      <td>2</td>
      <td>163</td>
      <td>163</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Stefanie</td>
      <td>3</td>
      <td>163</td>
      <td>163</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Manuela</td>
      <td>4</td>
      <td>164</td>
      <td>165</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Nadine</td>
      <td>5</td>
      <td>164</td>
      <td>163</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Sophia</td>
      <td>6</td>
      <td>164</td>
      <td>164</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Ellen</td>
      <td>7</td>
      <td>164</td>
      <td>164</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Emilia</td>
      <td>8</td>
      <td>165</td>
      <td>165</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Lina</td>
      <td>9</td>
      <td>165</td>
      <td>165</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Marie</td>
      <td>10</td>
      <td>165</td>
      <td>165</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Lena</td>
      <td>11</td>
      <td>165</td>
      <td>166</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Mila</td>
      <td>12</td>
      <td>165</td>
      <td>167</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Ida</td>
      <td>13</td>
      <td>165</td>
      <td>165</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Ella</td>
      <td>14</td>
      <td>166</td>
      <td>166</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Pia</td>
      <td>15</td>
      <td>166</td>
      <td>166</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Sarah</td>
      <td>16</td>
      <td>166</td>
      <td>166</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Lia</td>
      <td>17</td>
      <td>166</td>
      <td>166</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Lotta</td>
      <td>18</td>
      <td>167</td>
      <td>166</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Emma</td>
      <td>19</td>
      <td>167</td>
      <td>167</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Lina</td>
      <td>20</td>
      <td>168</td>
      <td>168</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="handle-missing-values">Handle missing values</h3>

<pre><code class="language-python"># show missing values (missing values - if present - will be displayed in yellow )
sns.heatmap(df.isnull(),yticklabels=False,cbar=False,cmap='viridis');
</code></pre>

<p><img src="output_17_0.png" alt="png" /></p>

<p>We can also check the column-wise distribution of null values:</p>

<pre><code class="language-python">print(df.isnull().sum())
</code></pre>

<pre><code>name              0
id                0
height            0
height_parents    0
dtype: int64
</code></pre>

<h2 id="transform-data">Transform data</h2>

<h3 id="descriptive-statistics">Descriptive statistics</h3>

<h4 id="measures-of-central-tendency">Measures of central tendency</h4>

<p>First of all we obtain some common statistics per variable.</p>

<pre><code class="language-python"># mode
df['height'].mode()
</code></pre>

<pre><code>0    165
dtype: int32
</code></pre>

<pre><code class="language-python"># calculate mean
print(f'The mean: {round(df[&quot;height&quot;].mean(),2)}')
# calculate median
print(f'The median: {df[&quot;height&quot;].median()}')
</code></pre>

<pre><code>The mean: 165.0
The median: 165.0
</code></pre>

<h4 id="measures-of-dispersion">Measures of dispersion</h4>

<pre><code class="language-python"># quantiles
df['height'].quantile([.25, .5, .75])
</code></pre>

<pre><code>0.25    164.0
0.50    165.0
0.75    166.0
Name: height, dtype: float64
</code></pre>

<pre><code class="language-python"># Range
df['height'].max() - df['height'].min()
</code></pre>

<pre><code>6
</code></pre>

<pre><code class="language-python"># standard deviation
round(df['height'].std(),2)
</code></pre>

<pre><code>1.49
</code></pre>

<h4 id="summary-statistics">Summary statistics</h4>

<pre><code class="language-python"># summary statistics for all numerical columns
round(df.describe(),2)
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>height</th>
      <th>height_parents</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>20.00</td>
      <td>20.00</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>165.00</td>
      <td>165.05</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.49</td>
      <td>1.67</td>
    </tr>
    <tr>
      <th>min</th>
      <td>162.00</td>
      <td>161.00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>164.00</td>
      <td>164.00</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>165.00</td>
      <td>165.00</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>166.00</td>
      <td>166.00</td>
    </tr>
    <tr>
      <th>max</th>
      <td>168.00</td>
      <td>168.00</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># summary statistics for all categorical columns
df.describe(include=['category'])
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>20</td>
      <td>20</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>18</td>
      <td>20</td>
    </tr>
    <tr>
      <th>top</th>
      <td>Stefanie</td>
      <td>9</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="visualize-data">Visualize data</h2>

<h3 id="distibution-of-variables">Distibution of Variables</h3>

<pre><code class="language-python"># histogram with seaborn
sns.distplot(df.height);
</code></pre>

<p><img src="output_35_0.png" alt="png" /></p>

<pre><code class="language-python">df.hist(bins=5, figsize=(10,5));
</code></pre>

<p><img src="output_36_0.png" alt="png" /></p>

<p>Another alternative to display the distribution of a continuous variable broken down by a categorical variable is the <strong>boxplot</strong>. A boxplot is a type of visual shorthand for a distribution of values that is popular among statisticians. Each boxplot consists of:</p>

<p>A box that stretches from the 25th percentile of the distribution to the 75th percentile, a distance known as the interquartile range (IQR). In the middle of the box is a line that displays the median, i.e. 50th percentile, of the distribution. These three lines give you a sense of the spread of the distribution and whether or not the distribution is symmetric about the median or skewed to one side.</p>

<p>Visual points that display observations that fall more than 1.5 times the IQR from either edge of the box. These outlying points are unusual so are plotted individually.</p>

<p>A line (or whisker) that extends from each end of the box and goes to the farthest non-outlier point in the distribution.</p>

<pre><code class="language-python"># boxplot
sns.boxplot(y='height', data=df, palette='winter');
</code></pre>

<p><img src="output_38_0.png" alt="png" /></p>

<pre><code class="language-python">df.boxplot(figsize=(10,10));
</code></pre>

<p><img src="output_39_0.png" alt="png" /></p>

<h3 id="relationship-between-variables">Relationship between variables</h3>

<pre><code class="language-python"># check relationship with a joint plot
sns.jointplot(x=&quot;height_parents&quot;, y=&quot;height&quot;, data=df, stat_func=None);
</code></pre>

<p><img src="output_41_0.png" alt="png" /></p>

<p>We can observe a strong relationship between the average height of the parents and the height of their daughter. Hence, it would make sense to use the variable &ldquo;height_parents&rdquo; as a predictor for the outcome variable &ldquo;height&rdquo; in a statistical model.</p>

<h2 id="model">Model</h2>

<p>If we are interested in discovering something about a phenomenon in the real world, we need to collect data to test predictions from our hypotheses about that phenomenon. Testing these hypotheses involves building statistical <strong>models</strong> of the phenomenon of interest.</p>

<p>It is important that the model accurately represents the real world, otherwise any conclusions we extrapolate to the real-world will be meaningless. Hence, the statistical model should represent the data collected (the observed data) as closely as possible.</p>

<p>$$Outcome_i = (Model) + error_i$$</p>

<p>This equation means that the data we observe can be predicted from the model we choose to fit plus some amount of error. There are different terms that basically refer to <strong>error</strong> like <strong>residual</strong>, <strong>deviation</strong> or <strong>deviance</strong>. The degree to which a statistical model represents the data collected is known as the <strong>fit of the model</strong> which is closely related to the error of the model.</p>

<p>The ‘model’ in the equation will vary depending on the design of your study, the type of data you have and what it is you’re trying to achieve with your model. Consequently, the model can also vary in its complexity.</p>

<p>The important thing is that we can use the model computed in our <strong>sample</strong> to estimate the value in the <strong>population</strong> (which is the value in which we’re interested).</p>

<h1 id="parameters">Parameters</h1>

<p>Statistical models are made up of <strong>variables</strong> and <strong>parameters</strong>. Variables are measured constructs that vary across entities in the sample. In contrast, parameters are not measured and are (usually) constants believed to represent some fundamental truth about the relations between variables in the model.</p>

<p>Some examples of parameters with which you already are familiar are: the <strong>mean</strong> and <strong>median</strong> (which estimate the centre of the distribution). We will also cover correlation and regression coefficients (which estimate the relationship between two variables) in other applications.</p>

<p>If we’re interested only in summarizing the outcome, as we are when we compute a <strong>mean</strong>, then we won’t have any variables in the model, only a <strong>parameter</strong> (typically called <em>b</em>), so we could write our $Outcome_i = (Model) + error_i$ equation as:</p>

<p>$Outcome_i = (b) + error_i$</p>

<hr />

<p>Let&rsquo;s say we would like to compare the <strong>quality of fit</strong> of two models to predict height: the simple mean and a second model in which we use information about the average height of their parents as a predictor in a linear regression model.</p>

<p><strong>Model 1: Mean</strong>
  * In the case of the <strong>mean</strong>, the <em>b</em> parameter is usually called $\bar{x}$, which leads to:</p>

<p>$height_i = (\bar{x}) + error_i$
  * with</p>

<p>$\bar{x} =  \frac {\sum<em>{i=1}^n x</em>{i}}{n}$</p>

<p><strong>Model 2: Linear Regression</strong>
  * In our second model, we use the variable height of parents as predictor in a linear regression model:</p>

<p>$height_i = (b_0 + b_i \times heightparents_i ) + error_i$</p>

<h3 id="model-1-mean">Model 1: Mean</h3>

<pre><code class="language-python"># calculate the mean
sum_x_i = df.height.sum()
n = len(df[&quot;height&quot;])
# formula for mean
x_bar = sum_x_i / n
print(x_bar)
</code></pre>

<pre><code>165.0
</code></pre>

<pre><code class="language-python"># calculate the mean
df[&quot;height&quot;].mean()
</code></pre>

<pre><code>165.0
</code></pre>

<pre><code class="language-python"># add the mean (as &quot;average&quot;) to our DataFrame
df = df.assign(average = df.height.mean())
df.head(5)
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>id</th>
      <th>height</th>
      <th>height_parents</th>
      <th>average</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Stefanie</td>
      <td>1</td>
      <td>162</td>
      <td>161</td>
      <td>165.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Petra</td>
      <td>2</td>
      <td>163</td>
      <td>163</td>
      <td>165.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Stefanie</td>
      <td>3</td>
      <td>163</td>
      <td>163</td>
      <td>165.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Manuela</td>
      <td>4</td>
      <td>164</td>
      <td>165</td>
      <td>165.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Nadine</td>
      <td>5</td>
      <td>164</td>
      <td>163</td>
      <td>165.0</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># create a scatterplot (plt)
plt = sns.scatterplot(x=&quot;id&quot;, y=&quot;height&quot;,data=df);
plt.set(xlabel='ID', ylabel='Height in cm', title='Error of th model');
plt.plot([0, 20], [165, 165], linewidth=2, color='r');
plt.text(1, 165.2,'mean = 165', rotation=0, color='r');
</code></pre>

<p><img src="output_49_0.png" alt="png" /></p>

<h3 id="model-2-linear-regression">Model 2: Linear Regression</h3>

<pre><code class="language-python"># fit linear model with statsmodels.formula.api (with R-style formulas)
lm = smf.ols(formula ='height ~ height_parents', data=df).fit()

# add the regression predictions (as &quot;pred&quot;) to our DataFrame
df['pred'] = lm.predict()
</code></pre>

<pre><code class="language-python">df.head(5)
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>id</th>
      <th>height</th>
      <th>height_parents</th>
      <th>average</th>
      <th>pred</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Stefanie</td>
      <td>1</td>
      <td>162</td>
      <td>161</td>
      <td>165.0</td>
      <td>161.711048</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Petra</td>
      <td>2</td>
      <td>163</td>
      <td>163</td>
      <td>165.0</td>
      <td>163.335222</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Stefanie</td>
      <td>3</td>
      <td>163</td>
      <td>163</td>
      <td>165.0</td>
      <td>163.335222</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Manuela</td>
      <td>4</td>
      <td>164</td>
      <td>165</td>
      <td>165.0</td>
      <td>164.959396</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Nadine</td>
      <td>5</td>
      <td>164</td>
      <td>163</td>
      <td>165.0</td>
      <td>163.335222</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">lm.summary()
</code></pre>

<p><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>height</td>      <th>  R-squared:         </th> <td>   0.831</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.822</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   88.78</td>
</tr>
<tr>
  <th>Date:</th>             <td>Mon, 13 May 2019</td> <th>  Prob (F-statistic):</th> <td>2.21e-08</td>
</tr>
<tr>
  <th>Time:</th>                 <td>11:20:24</td>     <th>  Log-Likelihood:    </th> <td> -17.995</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>    20</td>      <th>  AIC:               </th> <td>   39.99</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>    18</td>      <th>  BIC:               </th> <td>   41.98</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td><br />
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td><br />
</tr>
</table>
<table class="simpletable">
<tr>
         <td></td>           <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P&gt;|t|</th>  <th>[0.025</th>    <th>0.975]</th><br />
</tr>
<tr>
  <th>Intercept</th>      <td>   30.9651</td> <td>   14.226</td> <td>    2.177</td> <td> 0.043</td> <td>    1.077</td> <td>   60.853</td>
</tr>
<tr>
  <th>height_parents</th> <td>    0.8121</td> <td>    0.086</td> <td>    9.422</td> <td> 0.000</td> <td>    0.631</td> <td>    0.993</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 4.700</td> <th>  Durbin-Watson:     </th> <td>   1.384</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.095</td> <th>  Jarque-Bera (JB):  </th> <td>   2.492</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.684</td> <th>  Prob(JB):          </th> <td>   0.288</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.058</td> <th>  Cond. No.          </th> <td>1.67e+04</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 1.67e+04. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</p>

<pre><code class="language-python"># This is just a reminder of how the regression works. We make a prediction for X=200
b_0 = 30.9651
b_1 = 0.8121
X = 200
Vorhersage = b_0 + b_1*(X)
print(Vorhersage)
</code></pre>

<pre><code>193.38510000000002
</code></pre>

<pre><code class="language-python">df.head(5)
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>id</th>
      <th>height</th>
      <th>height_parents</th>
      <th>average</th>
      <th>pred</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Stefanie</td>
      <td>1</td>
      <td>162</td>
      <td>161</td>
      <td>165.0</td>
      <td>161.711048</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Petra</td>
      <td>2</td>
      <td>163</td>
      <td>163</td>
      <td>165.0</td>
      <td>163.335222</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Stefanie</td>
      <td>3</td>
      <td>163</td>
      <td>163</td>
      <td>165.0</td>
      <td>163.335222</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Manuela</td>
      <td>4</td>
      <td>164</td>
      <td>165</td>
      <td>165.0</td>
      <td>164.959396</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Nadine</td>
      <td>5</td>
      <td>164</td>
      <td>163</td>
      <td>165.0</td>
      <td>163.335222</td>
    </tr>
  </tbody>
</table>
</div>

<p>We use <a href="https://seaborn.pydata.org/generated/seaborn.lmplot.html" target="_blank">Seaborne&rsquo;s lmplot</a> to plot the regression line:</p>

<pre><code class="language-python"># Plot regression line
sns.lmplot(x='height_parents', y='height', data=df, line_kws={'color':'red'}, height=5, ci=None, );
</code></pre>

<p><img src="output_57_0.png" alt="png" /></p>

<pre><code class="language-python"># Regression results overview
lm.summary()
</code></pre>

<p><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>height</td>      <th>  R-squared:         </th> <td>   0.831</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.822</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   88.78</td>
</tr>
<tr>
  <th>Date:</th>             <td>Mon, 13 May 2019</td> <th>  Prob (F-statistic):</th> <td>2.21e-08</td>
</tr>
<tr>
  <th>Time:</th>                 <td>11:20:24</td>     <th>  Log-Likelihood:    </th> <td> -17.995</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>    20</td>      <th>  AIC:               </th> <td>   39.99</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>    18</td>      <th>  BIC:               </th> <td>   41.98</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td><br />
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td><br />
</tr>
</table>
<table class="simpletable">
<tr>
         <td></td>           <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P&gt;|t|</th>  <th>[0.025</th>    <th>0.975]</th><br />
</tr>
<tr>
  <th>Intercept</th>      <td>   30.9651</td> <td>   14.226</td> <td>    2.177</td> <td> 0.043</td> <td>    1.077</td> <td>   60.853</td>
</tr>
<tr>
  <th>height_parents</th> <td>    0.8121</td> <td>    0.086</td> <td>    9.422</td> <td> 0.000</td> <td>    0.631</td> <td>    0.993</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 4.700</td> <th>  Durbin-Watson:     </th> <td>   1.384</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.095</td> <th>  Jarque-Bera (JB):  </th> <td>   2.492</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.684</td> <th>  Prob(JB):          </th> <td>   0.288</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 4.058</td> <th>  Cond. No.          </th> <td>1.67e+04</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The condition number is large, 1.67e+04. This might indicate that there are<br/>strong multicollinearity or other numerical problems.</p>

<h2 id="measuring-the-quality-of-fit-errors">Measuring the quality of fit: errors</h2>

<p>In order to evaluate the performance of a statistical model on a given data set, we need some way to measure how well its predictions actually match the observed data. That is, we need to quantify the extent to which the predicted response value for a given observation is close to
the true response value for that observation.</p>

<p>With most statistical models we can determine whether the model represents the data well by looking at how different the scores we observed in the data are from the values that the model predicts.</p>

<p>$Outcome_i = (b) + error_i$, hence</p>

<p>$error_i = Outcome_i - (b)$</p>

<p>In other words, the error for a particular entity is the score predicted by the model for that entity subtracted from the corresponding observed score.</p>

<h3 id="sum-of-squared-errors-and-r-2">Sum of squared errors and $R^2$</h3>

<p>Errors cancel out because some are positive and others negative. Therefore, we square each deviation. If we add these squared deviations we get the <strong>Sum of Squared Errors (SS)</strong>.</p>

<p>$ SS = \sum_{i=1}^n (outcome_i - model_i)^2$</p>

<p>Using the <strong>mean</strong> of the outcome as a baseline model, we can calculate the difference between the observed values and the values predicted by the mean. We square these differences to give us the sum of squared differences. This sum of squared differences is known as the <strong>total sum of squares</strong> (denoted by $SS_T$) and it represents how good the mean is as a model of the observed outcome scores</p>

<p>$SS<em>T = \sum</em>{i=1}^n (observed_i - mean)^2$</p>

<p>We can use the values of $SS_T$ and the sum of squared residuals ($SS_R$)</p>

<p>$SS<em>R =  \sum</em>{i=1}^n (observed_i - model_i )^2$</p>

<p>to calculate how much better the linear model is than the baseline model of ‘no relationship’ (the mean). The improvement in prediction resulting from using the linear model rather than the mean is calculated as the difference between $SS_T$ and $SS_R$.</p>

<p>This difference shows us the reduction in the inaccuracy of the model resulting from fitting the regression model to the data. This improvement is the <strong>model sum of squares</strong>($SS_M$):</p>

<p>$SS_M = SS_T - SS_R$</p>

<p>If the value of $SS_M$ is <em>large</em>, the linear model is very different from using the mean to predict the outcome variable. This implies that the linear model has made a big improvement to predicting the outcome variable.</p>

<p>If $SS_M$ is <em>small</em> then using the linear model is little better than using the mean (i.e., the model is no better than predicting from ‘no relationship’).</p>

<p>A useful measure arising from these sums of squares is the proportion of improvement due to the model. This is calculated by dividing the sum of squares for the model by the total sum of squares to give a quantity called $R^2$</p>

<p>$$R^2 = \frac {SS_M}{SS_T}$$</p>

<p>with</p>

<p>$SS<em>T =  \sum</em>{i=1}^n (observed_i - mean)^2$</p>

<p>$SS<em>R =  \sum</em>{i=1}^n (observed_i - model_i )^2$</p>

<p>$SS_M = SS_T - SS_R$</p>

<p>To express the $R^2$-value as a percentage multiply it by 100. $R^2$ represents the amount of variance in the outcome explained by the model ($SS_M$) relative to how much variation there was to explain in the first place ($SS_T$): it represents the proportion of the variation in the outcome that can be predicted from the model. Therefore, it can take any value between 0% and 100%.</p>

<p><strong>Adjusted</strong> $R^2$: Whereas $R^2$ tells us how much of the variance in Y overlaps with predicted values from the model in our sample, adjusted $R^2$ tells us how much variance in Y would be accounted for if the model had been derived from the <strong>population</strong> from which the sample was taken (takes degrees of freedom into account). Therefore, the adjusted value indicates the loss of predictive power or shrinkage.</p>

<p><strong>As a general rule it is preferrable to use the adjusted $R^2$ instead of the simple $R^2$.</strong></p>

<h4 id="model-1-mean-1">Model 1: Mean</h4>

<pre><code class="language-python"># calculate error (observation - average) and assign it to dataframe
df = df.assign(error = (df['height'] - df['average']))
df.head(5)
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>id</th>
      <th>height</th>
      <th>height_parents</th>
      <th>average</th>
      <th>pred</th>
      <th>error</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Stefanie</td>
      <td>1</td>
      <td>162</td>
      <td>161</td>
      <td>165.0</td>
      <td>161.711048</td>
      <td>-3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Petra</td>
      <td>2</td>
      <td>163</td>
      <td>163</td>
      <td>165.0</td>
      <td>163.335222</td>
      <td>-2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Stefanie</td>
      <td>3</td>
      <td>163</td>
      <td>163</td>
      <td>165.0</td>
      <td>163.335222</td>
      <td>-2.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Manuela</td>
      <td>4</td>
      <td>164</td>
      <td>165</td>
      <td>165.0</td>
      <td>164.959396</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Nadine</td>
      <td>5</td>
      <td>164</td>
      <td>163</td>
      <td>165.0</td>
      <td>163.335222</td>
      <td>-1.0</td>
    </tr>
  </tbody>
</table>
</div>

<p>Note, that we can’t simply add deviances (the individual errors) because some errors are positive and others negative and so we’d get a total of zero.</p>

<p>total error = sum of errors</p>

<p>total error $= \sum_{i=1}^n (outcome_i - model_i)$</p>

<pre><code class="language-python"># calculate the sum of the errors
df.error.sum()
</code></pre>

<pre><code>0.0
</code></pre>

<pre><code class="language-python"># create a scatterplot (plt)
plt = sns.scatterplot(x=&quot;id&quot;, y=&quot;height&quot;,data=df,);
plt.set(xlabel='ID', ylabel='Height in cm', title='Error of th model');
plt.plot([0, 20], [165, 165], linewidth=2, color='r');
plt.text(1, 165.2,'mean = 165', rotation=0, color='r');
</code></pre>

<p><img src="output_64_0.png" alt="png" /></p>

<pre><code class="language-python"># residual plot
sns.residplot(x=&quot;average&quot;, y=&quot;height&quot;, data=df, scatter_kws={&quot;s&quot;: 80});
</code></pre>

<p><img src="output_65_0.png" alt="png" /></p>

<pre><code class="language-python"># calculate squared error and assign it to dataframe
df = df.assign(error_sq = (df['height'] - df['average'])**2)
df.head(5)
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>id</th>
      <th>height</th>
      <th>height_parents</th>
      <th>average</th>
      <th>pred</th>
      <th>error</th>
      <th>error_sq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Stefanie</td>
      <td>1</td>
      <td>162</td>
      <td>161</td>
      <td>165.0</td>
      <td>161.711048</td>
      <td>-3.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Petra</td>
      <td>2</td>
      <td>163</td>
      <td>163</td>
      <td>165.0</td>
      <td>163.335222</td>
      <td>-2.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Stefanie</td>
      <td>3</td>
      <td>163</td>
      <td>163</td>
      <td>165.0</td>
      <td>163.335222</td>
      <td>-2.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Manuela</td>
      <td>4</td>
      <td>164</td>
      <td>165</td>
      <td>165.0</td>
      <td>164.959396</td>
      <td>-1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Nadine</td>
      <td>5</td>
      <td>164</td>
      <td>163</td>
      <td>165.0</td>
      <td>163.335222</td>
      <td>-1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># calculate sum of squared error (which is in case of the mean the total error)
SS_T = df.error_sq.sum()
# print output
print('Sum of squared error (SS_T) of model 1:', SS_T)
</code></pre>

<pre><code>Sum of squared error (SS_T) of model 1: 42.0
</code></pre>

<h4 id="model-2-linear-regression-1">Model 2: Linear Regression</h4>

<pre><code class="language-python">lm.resid.sum()
</code></pre>

<pre><code>4.206412995699793e-12
</code></pre>

<pre><code class="language-python"># obtain the residuals from statsmodel (resid)
df['error_2'] = lm.resid
# square the residuals
df['error_sq_2'] = df['error_2']**2
# show df
df.head(5)
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>id</th>
      <th>height</th>
      <th>height_parents</th>
      <th>average</th>
      <th>pred</th>
      <th>error</th>
      <th>error_sq</th>
      <th>error_2</th>
      <th>error_sq_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Stefanie</td>
      <td>1</td>
      <td>162</td>
      <td>161</td>
      <td>165.0</td>
      <td>161.711048</td>
      <td>-3.0</td>
      <td>9.0</td>
      <td>0.288952</td>
      <td>0.083493</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Petra</td>
      <td>2</td>
      <td>163</td>
      <td>163</td>
      <td>165.0</td>
      <td>163.335222</td>
      <td>-2.0</td>
      <td>4.0</td>
      <td>-0.335222</td>
      <td>0.112374</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Stefanie</td>
      <td>3</td>
      <td>163</td>
      <td>163</td>
      <td>165.0</td>
      <td>163.335222</td>
      <td>-2.0</td>
      <td>4.0</td>
      <td>-0.335222</td>
      <td>0.112374</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Manuela</td>
      <td>4</td>
      <td>164</td>
      <td>165</td>
      <td>165.0</td>
      <td>164.959396</td>
      <td>-1.0</td>
      <td>1.0</td>
      <td>-0.959396</td>
      <td>0.920440</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Nadine</td>
      <td>5</td>
      <td>164</td>
      <td>163</td>
      <td>165.0</td>
      <td>163.335222</td>
      <td>-1.0</td>
      <td>1.0</td>
      <td>0.664778</td>
      <td>0.441930</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># Total sum of squares (SS_T: sum of squared errors of the base model, i.e. the mean)
print(SS_T)
</code></pre>

<pre><code>42.0
</code></pre>

<pre><code class="language-python"># Sum of squared residuals (SS_R)
SS_R = df['error_sq_2'].sum()
print(SS_R)
# SS_R – Sum of squared (whitened) residuals from statsmodel function
lm.ssr
</code></pre>

<pre><code>7.0802644003777155





7.080264400377715
</code></pre>

<pre><code class="language-python"># Plot regression line
sns.lmplot(x='height_parents', y='height', data=df, line_kws={'color':'red'}, height=5, ci=None);
</code></pre>

<p><img src="output_73_0.png" alt="png" /></p>

<pre><code class="language-python">sns.residplot(x=&quot;height_parents&quot;, y=&quot;height&quot;, data=df, scatter_kws={&quot;s&quot;: 80});
</code></pre>

<p><img src="output_74_0.png" alt="png" /></p>

<pre><code class="language-python"># Explained sum of squares  (SS_M = SS_T - SS_R)
SS_M = SS_T - SS_R
print(SS_M)
# Explained sum of squres (SS_M) from statsmodel function
lm.ess
</code></pre>

<pre><code>34.919735599622285





34.919735599622285
</code></pre>

<p>$R^2$ is the proportion of the variance in the dependent variable that is predictable from the independent variable</p>

<pre><code class="language-python"># R_Squared: explained sum of squared residuals
R_squared = SS_M / SS_T
print(R_squared)
</code></pre>

<pre><code>0.831422276181483
</code></pre>

<pre><code class="language-python"># R_Squared of statsmodel
lm.rsquared
</code></pre>

<pre><code>0.831422276181483
</code></pre>

<pre><code class="language-python"># Adjusted R_Squared:
lm.rsquared_adj
</code></pre>

<pre><code>0.8220568470804543
</code></pre>

<h3 id="pearson-s-correlation-coefficient">Pearson&rsquo;s correlation coefficient</h3>

<p>We just saw that $R^2$ represents the proportion of the variation in the outcome that can be predicted from the model:</p>

<p>$R^2 = \frac{SS_M}{SS_T}$</p>

<p>with</p>

<p>$SS<em>T =  \sum</em>{i=1}^n (observed_i - mean)^2$</p>

<p>$SS<em>R =  \sum</em>{i=1}^n (observed_i - model_i )^2$</p>

<p>$SS_M = SS_T - SS_R$</p>

<p>We can take the square root of this value to obtain <strong>Pearson’s correlation coefficient</strong> (we cover the topic of correlation in a separate application in detail) for the relationship between the values of the outcome predicted by the model and the observed values of the outcome. With only one predictor in the model this value will be the same as the Pearson correlation coefficient between the predictor and outcome variable.</p>

<p>$r = \sqrt{R^2} = \sqrt{\frac{SS_M}{SS_T}}$</p>

<p>As such, the correlation coefficient provides us with a good estimate of the overall fit of the regression model (i.e., the correspondence between predicted values of the outcome and the actual values), and $R^2$ provides us with a gauge of the substantive size of the model fit.</p>

<p><strong>Interpretation of r:</strong></p>

<p>$- 1 ≤ r ≤ 1$</p>

<p>With a perfect relationship (r = −1 or 1) the observed data basically fall exactly on the line (the model is a perfect fit to the data), but for a weaker relationship (r = −0.5 or 0.5) the observed data are scattered more widely around the line.</p>

<ul>
<li>| r | = 0.10 (small effect)</li>
<li>| r | = 0.30 (medium effect)</li>
<li>| r | = 0.50 (large effect)</li>
</ul>

<p>It’s worth bearing in mind that r is not measured on a linear scale, so an effect with r = 0.6 isn’t twice as big as one with r = 0.3.</p>

<h4 id="model-2-linear-regression-2">Model 2: Linear Regression</h4>

<pre><code class="language-python"># correlation coefficient r
r = np.sqrt(R_squared)
print(r)
</code></pre>

<pre><code>0.911823599267689
</code></pre>

<pre><code class="language-python"># correlation coefficient with p-value
stats.pearsonr(df['height'], df['height_parents'])
</code></pre>

<pre><code>(0.9118235992676891, 2.214412891654905e-08)
</code></pre>

<h3 id="mean-squared-error-variance-and-standard-deviation">Mean squared error, variance and standard deviation</h3>

<p>Although the <strong>sum of squared errors (SS)</strong> is a good measure of the accuracy of our model, it depends upon the quantity of data that has been collected – the more data points, the higher the SS.</p>

<p>By using the <strong>average error</strong>, rather than the total, we can overcome this problem. This measure is called the &ldquo;<strong>Mean Squared Error (MSE)</strong>&rdquo;. In the regression setting, it is the most commonly-used measure to evaluate the performance of a model.</p>

<p>To compute the average error we divide the sum of squares by the number of values that we used to compute that total. We again come back to the problem that we’re usually interested in the error in the model in the <strong>population</strong> (not the <strong>sample</strong>).</p>

<p>To estimate the mean error in the population we need to divide not by the number of scores contributing to the total, but by the <strong>degrees of freedom (df)</strong>, which is the number of scores used to compute the total adjusted for the fact that we’re trying to estimate the population value. Note: you may encounter different formulas for calculating the mse. Some only devide by the number of observations and not the df.</p>

<p>Mean squared error:</p>

<p>$$ MSE = \frac {SS}{df} = \frac {\sum_{i=1}^n (outcome_i - model_i)^2}{df}$$</p>

<p>The <strong>mean squared error</strong> is also known as the <strong>variance</strong>. Furthermore, the <strong>standard deviation</strong> is the square root of the variance:</p>

<p>$$Variance = s^2 = \frac {SS}{df} = \frac {\sum_{i=1}^n (outcome_i - model_i)^2}{df}$$</p>

<p>Standard Deviation = $$\sqrt{s^2} = \sqrt{\frac{\sum\limits<em>{i=1}^{n} \left(x</em>{i} - \bar{x}\right)^{2}} {df}}$$</p>

<p>which equals:</p>

<p>$$ s =  \frac {\sum_{i=1}^n (outcome_i - model_i)}{df}$$</p>

<p>A small <strong>standard deviation</strong> represented a scenario in which most data points were close to the mean, whereas a large standard deviation represented a situation in which data points were widely spread from the mean.</p>

<h4 id="model-1-mean-2">Model 1: Mean</h4>

<pre><code class="language-python"># calculate mean squared error of the model 1 &quot;the mean&quot;
# Number of obeservations (lenght of DataFrame)
n = len(df[&quot;height&quot;])
# calculate mse
mse = (SS_T/(n-1))
# print output
print('Mean squared error of the mean:', mse)
</code></pre>

<pre><code>Mean squared error of the mean: 2.210526315789474
</code></pre>

<p>Mean squared error =  $\frac {SS}{df} = \frac {\sum_{i=1}^n (outcome_i - model<em>i)^2}{df} = \frac {\sum</em>{i=1}^n(x_i-\bar{x})^2}{df} = \frac {42}{19} = 2.210$</p>

<p>In our example, $n=20$, we have one parameter, p=1 (the mean), and therefore, the degrees of freedom are df = (p-1) = 20-1 = 19.</p>

<pre><code class="language-python"># generate a variable called variance (to illustrate relationship between variance and standard deviation)
variance = mse
# obtain the standard deviation
print(f'Standard deviation (SD) of model 1 = {round(np.sqrt(variance),2)}')
</code></pre>

<pre><code>Standard deviation (SD) of model 1 = 1.49
</code></pre>

<h4 id="model-2-linear-regression-3">Model 2: Linear Regression</h4>

<p>Statsmodel provide us with different options (we use mse_resid and mse_total):</p>

<ul>
<li>mse_model : Mean squared error the model. This is the explained sum of squares divided by the model degrees of freedom.</li>
<li>mse_resid : Mean squared error of the residuals. The sum of squared residuals divided by the residual degrees of freedom.</li>
<li>mse_total : Total mean squared error. Defined as the uncentered total sum of squares divided by n the number of observations.</li>
</ul>

<pre><code class="language-python"># Total MSE_T (this is the MSE of the basline mean model) from statsmodel
MSE_T = lm.mse_total
# print output
print('Total mean squared error (MSE_T):', MSE_T)
# compare this result to mse... they are the same
</code></pre>

<pre><code>Total mean squared error (MSE_T): 2.210526315789474
</code></pre>

<pre><code class="language-python"># Mean squared error of residuals (MSE_R)
MSE_R = SS_R / (20-2)
print('Mean squared error of residuals (MSE_R):', MSE_R)
# MSE of residuals from statsmodel (preferred)
print(f'Mean squared error od residuals (MSE_R): {lm.mse_resid}')
</code></pre>

<pre><code>Mean squared error of residuals (MSE_R): 0.3933480222432064
Mean squared error od residuals (MSE_R): 0.39334802224320636
</code></pre>

<pre><code class="language-python"># the standard deviation equals the root of the MSE_R
print(f'Standard deviation (SD) of model 2 = {round(np.sqrt(MSE_R),2)}')
</code></pre>

<pre><code>Standard deviation (SD) of model 2 = 0.63
</code></pre>

<h3 id="f-statistic">F-Statistic</h3>

<p>A second use of the sums of squares in assessing the model is the <strong>F-test</strong>. Test statistics (like F) are usually the amount of <strong>systematic variance</strong> divided by the amount of <strong>unsystematic variance</strong>, or, put another way, the model compared to the error in the model. This is true here: F is based upon the ratio of the improvement due to the model ($SS_M$) and the error in the model ($SS_R$).</p>

<p>Because the sums of squares depend on the number of differences that were added up, the <strong>average sums of squares</strong> (referred to as the <strong>mean squares</strong> or <strong>MS</strong>) are used to compute F.</p>

<p>The <strong>mean sum of squares</strong> is the sum of squares divided by the associated degrees of freedom (this is comparable to calculating the variance from the sums of squares).</p>

<p>For $SS_M$ the degrees of freedom are the number of predictors in the model (<em>p</em>), and for $SS_R$ they are the number of observations (<em>n</em>) minus the number of parameters being estimated (i.e., the number of b coefficients including the constant).</p>

<p>We estimate a &ldquo;b&rdquo; for each predictor and the intercept ($b_0$), so the total number of b&rsquo;s estimated will be <em>p + 1</em>, giving us degrees of freedom of n - (p + 1) or, more simply, n - p - 1. Thus:</p>

<p>$MS_M = \frac{SS_M}{p}$</p>

<p>$MS_R = \frac{SS_R}{n-p-1}$</p>

<p><strong>The F-statistic computed from these mean squares</strong></p>

<p>$$F = \frac{Systematic Variance}{Unsystematic Variance} = \frac{MS_M}{MS_R}$$</p>

<p>is a measure of how much the model has <em>improved</em> the prediction of the outcome compared to the level of inaccuracy of the model. If a model is good, then the improvement in prediction from using the model should be large ($MS_M$ will be large) and the difference between the model and the observed data should be small ($MS_R$ will be small).</p>

<p>In short, for a good model the numerator in the equation above will be bigger than the denominator, resulting in a large F-statistic (greater than 1 at least).</p>

<p>This F has an associated probability distribution from which a <strong>p-value</strong> can be derived to tell us the probability of getting an F at least as big as the one we have if the null hypothesis were true. The null hypothesis in this case is a flat model (predicted values of the outcome are the same regardless of the value of the predictors).</p>

<p>The F-statistic is also used to calculate the significance of $R^2$ using the following equation:</p>

<p>$F = \frac{(n-p-1)R^2}{p(1-R^2)}$</p>

<p>in which n is the number of cases or participants, and p is the number of predictors in the model. This F tests the null hypothesis that $R^2$ is zero (i.e., there is no improvement in the sum of squared error due to fitting the model).</p>

<h4 id="model-2-linear-regression-4">Model 2: Linear Regression</h4>

<pre><code class="language-python"># Mean squared error of the model (MSE_M)
p = 1 # we only have one predictor (height_parents)
MS_M = (SS_M / p)
print('MS_M =', MS_M)
# MSE_M of residuals from statsmodel
print(f'MS_M = {lm.mse_model}')
</code></pre>

<pre><code>MS_M = 34.919735599622285
MS_M = 34.919735599622285
</code></pre>

<pre><code class="language-python"># Adjust notation and calculate F-value
MS_R = MSE_R
# F-value
F_value = (MS_M / MS_R)
print(F_value)
</code></pre>

<pre><code>88.77567351293678
</code></pre>

<pre><code class="language-python"># statsmodel
# Alternative way to obtain F-value (preferred)
print(lm.fvalue)
# which of course equals
F_val = (lm.mse_model / lm.mse_resid)
print(F_val)
</code></pre>

<pre><code>88.77567351293679
88.77567351293679
</code></pre>

<h3 id="5-2-5-standard-error">5.2.5 Standard error</h3>

<p>We just learned that the <strong>standard deviation</strong> tells us about how well the mean represents the sample data. However, if we’re using the <strong>sample mean</strong> to estimate this parameter in the <strong>population</strong> (like we did), then we need to know how well it represents the value in the population, especially because samples from a population differ.</p>

<p>Imagine that we were interested in the height of <em>all</em> adult women in germany (so adult women in germany are the <strong>population</strong>). We could take a <strong>sample</strong> from this population (like we did with our 20 women), and when we do we are taking one of many possible samples. If we were to take several samples from the same population, then each sample would have its own mean, and some of these sample means will be different.</p>

<p>Imagine we could obtain the height of all adult women in germany and could compute the mean of their height (which would equal $\mu$ = 168 cm). Then we would know, as an absolute fact, that the mean of the height is 168 cm (this is the population mean, <strong>µ</strong>, the parameter that we’re trying to estimate).</p>

<p>In reality, we don’t have access to the population, so we use a sample. In this sample we calculate the average height, known as the <strong>sample mean</strong> ($\bar{x}$), and discover it is 168 cm; that is, adult women in our sample are 168 cm tall, on average. Now we take a second sample and find that women in this sample are, on average, only 167 cm tall. In other words, the sample mean is different in the second sample than in the first.</p>

<p>This difference illustrates <strong>sampling variation</strong>: that is, samples vary because they contain different members of the population; a sample that, by chance, includes relatively tall women will have a higher average than a sample that, by chance, includes some women who are relatively short.</p>

<p>Imagine that we now take a lot of samples (let&rsquo;s say 1000). If we plotted the resulting sample means as a histogram, we would observe a symmetrical distribution known as a <strong>sampling distribution</strong>.</p>

<p>A <strong>sampling distribution</strong> is the frequency distribution of sample means (or whatever parameter you’re trying to estimate) from the same population. You need to imagine that we’re taking hundreds or thousands of samples to construct a sampling distribution.</p>

<p>The sampling distribution of the mean tells us about the behaviour of samples from the population, and it is centred at around the same value as the mean of the population. Therefore, if we took the average of all sample means we’d get the value of the <strong>population mean</strong>.</p>

<p>We can use the sampling distribution to tell us how <em>representative a sample</em> is of the population. Think back to the <strong>standard deviation</strong>. We used the standard deviation as a measure of how representative the mean was of the observed data.</p>

<p>A small standard deviation represented a scenario in which most data points were close to the mean, whereas a large standard deviation represented a situation in which data points were widely spread from the mean. If our ‘observed data’ are sample means then the standard deviation of these sample means would similarly tell us how widely spread (i.e., how representative) sample means are around their average. Bearing in mind that the <em>average of the sample means</em> is the same as the <em>population mean</em>, the standard deviation of the sample means would therefore tell us how widely sample means are spread around the population mean: put another way, it tells us whether sample means are typically representative of the population mean.</p>

<p>The standard deviation of sample means is known as the <strong>standard error of the mean (SE)</strong> or standard error for short. Theoretically, the standard error could be calculated by taking the difference between each sample mean and the overall mean, squaring these differences, adding them up, and then dividing by the number of samples. Finally, the square root of this value would need to be taken to get the standard deviation of sample means: the standard error. In the real world, it would be to costly to collect thousands of samples, and so we compute the standard error from a mathematical approximation.</p>

<p>Statisticians have demonstrated something called the <strong>central limit theorem</strong>, which tells us that as samples get large (usually defined as greater than 30), the sampling distribution has a normal distribution with a mean equal to the population mean, and we can calculate the standard deviation as follows:</p>

<p>$$\sigma_{\bar{X}} = \frac{s} {\sqrt{N}}$$</p>

<p>Hence, if our sample is largeer than n=30 we can use the equation above to approximate the standard error (because it is the standard deviation of the sampling distribution).
Note: when the sample is relatively small (fewer than 30) the sampling distribution is not normal: it has a different shape, known as a <strong>t-distribution</strong>, which we’ll cover later.</p>

<p><strong>Summary</strong></p>

<ul>
<li>The standard error of the mean is the standard deviation of sample means.</li>
<li>As such, it is a measure of how representative of the population a sample mean is likely to be.</li>
<li>A large standard error (relative to the sample mean) means that there is a lot of variability between the means of different samples and so the sample mean we have might not be representative of the population mean.</li>
<li>A small standard error indicates that most sample means are similar to the population mean (i.e., our sample mean is likely to accurately reflect the population mean).</li>
</ul>

<h4 id="model-1-mean-3">Model 1: Mean</h4>

<pre><code class="language-python"># calculate standard error (...we ignore the fact that our sample is small since n &lt; 30)
se = df['height'].sem()
print(se)
# assign se to df
df = df.assign(se=se)
</code></pre>

<pre><code>0.33245498310218435
</code></pre>

<pre><code class="language-python"># alternative way to calculate standard error (se)
# calculate standard deviation (s)
s = df[&quot;height&quot;].std()
# calculate se
se = (s/np.sqrt(n))
print(se)
</code></pre>

<pre><code>0.33245498310218435
</code></pre>

<h4 id="model-2-linear-regression-5">Model 2: Linear Regression</h4>

<pre><code class="language-python"># Get standard error of parameters
se_2 = lm.bse
print('Standard error (SE) od model 2:', se_2)
</code></pre>

<pre><code>Standard error (SE) od model 2: Intercept         14.226306
height_parents     0.086190
dtype: float64
</code></pre>

<h3 id="confidence-interval">Confidence interval</h3>

<p>As a brief recap, we usually use a <strong>sample value</strong> as an estimate of a <strong>parameter</strong> (e.g., the mean or any other parameter b) in the <strong>population</strong>. We’ve just seen that the <strong>estimate of a parameter</strong> (e.g., the mean) will differ across samples, and we can use the <strong>standard error</strong> to get some idea of the extent to which these estimates differ across samples. We can also use this information to calculate boundaries within which we believe the population value will fall. Such boundaries are called <strong>confidence intervals</strong>.</p>

<p>For example, perhaps we might want to know how often, <em>in the long run</em>, an interval contains the true value of the parameter we’re trying to estimate (in the case of model 1, the mean). This is what a <strong>confidence interval</strong> does. Typically, we look at 95% confidence intervals, and sometimes 99% confidence intervals, but they all have a similar interpretation: they are limits constructed such that, for a certain percentage of samples (be that 95% or 99%), the true value of the population parameter falls within the limits. So, when you see a 95% confidence interval for a mean, think of it like this:</p>

<ul>
<li>if we’d collected 100 samples, and for each sample calculated the parameter (e.g. the mean) and a confidence interval for it, then for 95 of these samples, the confidence interval contains the value of the parameter (e.g. the mean) in the population, and in 5 of the samples the confidence interval does not contain the population paramater (e.g. the mean).</li>
</ul>

<p>The trouble is, you do not know whether the confidence interval from a particular sample is one of the 95% that contain the true value or one of the 5% that do not.</p>

<p>Here is an example of a common wrong interpretation of confidence intervalls:</p>

<ul>
<li><strong>Wrong</strong> interpretation: a 95% confidence interval has a 95% probability of containing the population parameter.</li>
</ul>

<p>It is a common mistake, but this is <em>not</em> true. The 95% reflects a <em>long-run probability</em>. It means that if you take repeated samples and construct confidence intervals, then 95% of them will contain the population value. That is not the same as a particular confidence interval for a specific sample having a 95% probability of containing the value. In fact, for a specific confidence interval, the probability that it contains the population value is either 0 (it does not contain it) or 1 (it does contain it). You have no way of knowing which it is.</p>

<p>We know (in large samples) that the sampling distribution of parameters (e.g. means) will be normal, and the <strong>normal distribution</strong> has been precisely defined such that it has a mean of 0 and a standard deviation of 1. We can use this information to compute the probability of a score occurring, or the limits between which a certain percentage of scores fall.</p>

<p>We make use of the fact that 95% of <strong>z-scores</strong> fall between −1.96 and 1.96. This means that if our sample parameters (e.g. means) were normally distributed with a mean of 0 and a standard error of 1, then the limits of our confidence interval would be −1.96 and +1.96. Luckily we know from the <strong>central limit theorem</strong> that in large samples (above about 30) the sampling distribution will be normally distributed.</p>

<p><strong>Visualize confidence intervals in plots</strong></p>

<p>We saw that confidence intervals provide us with information about a parameter, and, therefore, you often see them displayed on graphs.</p>

<p>The confidence interval is usually displayed using something called an <strong>error bar</strong>, which looks like the letter ‘I’. An error bar can represent the <strong>standard deviation</strong>, or the <strong>standard error</strong>, but more often than not it shows the <strong>95% confidence interval</strong> of the mean. So, often when you see a graph showing the mean, perhaps displayed as a bar or a symbol, it is accompanied by this I-shaped bar.</p>

<h4 id="model-1-the-mean">Model 1: The Mean</h4>

<p>First of all, we convert scores so that they have a mean of 0 and standard deviation of 1 (<strong>z-scores</strong>) using this equation:</p>

<p>$$z = \frac{X-\bar{X}}{s}$$</p>

<pre><code class="language-python"># calculate z-scores
z = stats.zscore(df.height)
print(z)
# assign z-scores to df
df = df.assign(z = z)
</code></pre>

<pre><code>[-2.07019668 -1.38013112 -1.38013112 -0.69006556 -0.69006556 -0.69006556
 -0.69006556  0.          0.          0.          0.          0.
  0.          0.69006556  0.69006556  0.69006556  0.69006556  1.38013112
  1.38013112  2.07019668]
</code></pre>

<pre><code class="language-python">plt = sns.distplot(df.z);
# draw a vertical line
plt.axvline(1.96, 0, 1, linewidth=2, color='r');
# add text
plt.text(2.1, 0.3,'z = 1.96', rotation=90, color='r');
plt.axvline(-1.96, 0, 1, linewidth=2, color='r');
plt.text(-2.2, 0.3,'z = -1.96', rotation=90, color='r');
</code></pre>

<p><img src="output_109_0.png" alt="png" /></p>

<p>If we know that our limits are −1.96 and 1.96 as z-scores, then to find out the corresponding scores in our raw data we can replace z in the equation (because there are two values, we get two equations):</p>

<p>$$1.96 = \frac{X-\bar{X}}{s}$$</p>

<p>and</p>

<p>$$-1.96 = \frac{X-\bar{X}}{s}$$</p>

<p>We rearrange these equations to discover the value of X:</p>

<p>$$1.96 \times s = X - \bar{X}$$</p>

<p>$$(1.96 \times s) + \bar{X} = X$$</p>

<p>and</p>

<p>$$-1.96 \times s = X - \bar{X}$$</p>

<p>$$(-1.96 \times s) + \bar{X} = X$$</p>

<p>Therefore, the confidence interval can easily be calculated once the <strong>standard deviation</strong> (s in the equation) and <strong>mean</strong> ($\bar{x}$ in the equation) are known.</p>

<p>However, we use the <strong>standard error</strong> and not the standard deviation because we’re interested in the variability of sample means, not the variability in observations within the sample.</p>

<p>The lower boundary of the confidence interval is, therefore, the mean minus 1.96 times the standard error, and the upper boundary is the mean plus 1.96 standard errors:</p>

<p><strong>lower boundary of confidence intervall</strong> = $\bar{X} - (1.96 \times SE)$</p>

<p><strong>upper boundary of confidence intervall</strong> = $\bar{X} + (1.96 \times SE)$</p>

<p>As such, the mean is always in the centre of the confidence interval. We know that 95% of confidence intervals contain the population mean, so we can assume this confidence interval contains the true mean; therefore, if the interval is small,the sample mean must be very close to the true man. Conversely, if the confidenve interval is very wide then the sample mean could be very different from the true mean, indicating that it is a bad representation of the population.</p>

<pre><code class="language-python"># lower boundary
lb = (df.height.mean() - (1.96*se))
# upper boundary
up = (df.height.mean() + (1.96*se))
print('Lower boundary of CI', lb)
print('Upper boundary of CI', up)
</code></pre>

<pre><code>Lower boundary of CI 164.34838823311972
Upper boundary of CI 165.65161176688028
</code></pre>

<pre><code class="language-python"># draw limits of confidence intervall
plt = sns.distplot(df.height);
# draw a vertical line to mark the mean
plt.axvline(165, 0, 1, linewidth=3, color='b');
# add text
plt.text(165.1, 0.1,'Mean = 165', rotation=90, color='b');
# draw a vertical line to mark the lower limit of the confidence intervall
plt.axvline(164.348388, 0, 1, linewidth=3, color='w');
# add text
plt.text(164, 0.15,'Lower limit = 164.34 ', rotation=90, color='w');
# draw a vertical line to mark the upper limit of the confidence intervall
plt.axvline(165.651612, 0, 1, linewidth=3, color='w');
plt.text(165.8, 0.15,'Upper limit = 165.65', rotation=90, color='w');
</code></pre>

<p><img src="output_112_0.png" alt="png" /></p>

<h4 id="model-2-linear-regression-6">Model 2: Linear Regression</h4>

<p>Confidence intervall for parameter $b_1$ (height_parents)</p>

<p><strong>lower boundary of confidence intervall</strong> = $b_1 - (1.96 \times SE(b_1))$</p>

<p><strong>upper boundary of confidence intervall</strong> = $b_1 + (1.96 \times SE(b_1))$</p>

<pre><code class="language-python"># Obtain confidence interval for fitted parameters
lm.conf_int(alpha=0.05)
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Intercept</th>
      <td>1.076702</td>
      <td>60.853420</td>
    </tr>
    <tr>
      <th>height_parents</th>
      <td>0.631009</td>
      <td>0.993165</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># Make a prediction for height when parents average height is 168 cm
to_predict = pd.DataFrame({'height_parents':[168]})
results = lm.get_prediction(to_predict)
round(results.summary_frame(alpha=0.05),2)
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>mean_se</th>
      <th>mean_ci_lower</th>
      <th>mean_ci_upper</th>
      <th>obs_ci_lower</th>
      <th>obs_ci_upper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>167.4</td>
      <td>0.29</td>
      <td>166.79</td>
      <td>168.01</td>
      <td>165.94</td>
      <td>168.85</td>
    </tr>
  </tbody>
</table>
</div>

<ul>
<li>The predicted height for an average parents height of 168 cm is 167.4.</li>
<li>For 95% the confidence interval is [166.79, 168.01] and the prediction interval is [165.94, 168.85]</li>
</ul>

<p>How much will the outcome vary from our prediction? We use <strong>prediction intervals</strong> (obs_ci_lower and obs_ci_uppper) to answer this question. Prediction intervals are always wider than confidence intervals, because they incorporate both the error in the estimate for f(X) (the reducible error) and the uncertainty as to how much an individual point will differ from the population regression (the irreducible error).</p>

<p>We interpret this to mean that 95% of intervals of this form will contain the true value of Y for parents with this average height. Note that both intervals are centered at 167.4 cm, but that the <strong>prediction interval</strong> is substantially wider than the confidence interval, reflecting the increased uncertainty about the individual height for given parents height in comparison to the average height of many parents.</p>

<pre><code class="language-python"># Plot regression line with CI 95%
sns.lmplot(x='height_parents', y='height', data=df, order=1, line_kws={'color':'red'}, size=7, aspect=1.5, ci=95);
</code></pre>

<pre><code>/Users/jankirenz/anaconda3/lib/python3.6/site-packages/seaborn/regression.py:546: UserWarning: The `size` paramter has been renamed to `height`; please update your code.
  warnings.warn(msg, UserWarning)
</code></pre>

<p><img src="output_119_1.png" alt="png" /></p>

<hr />

<h3 id="confidence-intervals-in-small-samples">Confidence intervals in small samples</h3>

<p>The procedure we just used is fine when samples are large, because the central limit theorem tells us that the sampling distribution will be normal. However, for small samples, the sampling distribution is not normal – it has a t-distribution. The t-distribution is a family of probability distributions that change shape as the sample size gets bigger (when the sample is very big, it has the shape of a normal distribution).</p>

<p>To construct a confidence interval in a small sample we use the same principle as before, but instead of using the value for z we use the value for t:</p>

<p>lower boundary of confidence intervall = $\bar{X} - (t_{n-1} \times SE)$</p>

<p>upper boundary of confidence intervall = $\bar{X} + (t_{n-1}  \times SE)$</p>

<p>The (n − 1) in the equations is the degrees of freedom and tells us which of the t-distributions to use. For a 95% confidence interval, we can calculate the value of t for a two-tailed test with probability of 0.05, for the appropriate degrees of freedom.</p>

<pre><code class="language-python"># calculate t-statistic
# 95% confidence interval, two tailed test,
# p&lt;0.05 (we need to take 0.025 at each side), n=20, df=19
t = stats.t.ppf(1-0.025, 19)
print(t)
# lower boundary
lb_t = (df.height.mean() - (t*se))
# upper boundary
up_t = (df.height.mean() + (t*se))
print('Lower boundary of CI (t-statistics)', lb_t)
print('Upper boundary of CI (t-statistics)', up_t)
</code></pre>

<pre><code>2.093024054408263
Lower boundary of CI (t-statistics) 164.30416372335924
Upper boundary of CI (t-statistics) 165.69583627664076
</code></pre>

<pre><code class="language-python"># draw limits of confidence intervall for t-statistic
plt = sns.distplot(df.height);
# draw a vertical line to mark the mean
plt.axvline(165, 0, 1, linewidth=3, color='b');
# add text
plt.text(165.1, 0.1,'Mean = 165', rotation=90, color='b');
# draw a vertical line to mark the lower limit of the confidence intervall
plt.axvline(164.304164, 0, 1, linewidth=3, color='r');
# add text
plt.text(164, 0.15,'Lower limit = 164.30 ', rotation=90, color='r');
# draw a vertical line to mark the upper limit of the confidence intervall
plt.axvline(165.695836, 0, 1, linewidth=3, color='r');
plt.text(165.8, 0.15,'Upper limit = 165.69', rotation=90, color='r');
</code></pre>

<p><img src="output_123_0.png" alt="png" /></p>

<pre><code class="language-python"># compare CI z-statistic with t-statistic
# draw limits of confidence intervall
plt = sns.distplot(df.height);
# draw a vertical line to mark the mean
plt.axvline(165, 0, 1, linewidth=3, color='b');
# add text
# draw vertical lines to mark the lower/upper limit of the confidence intervall (z)
plt.axvline(164.348388, 0, 1, linewidth=3, color='w');
plt.axvline(165.651612, 0, 1, linewidth=3, color='w');
# draw vertical lines to mark the lower/upper limit of the confidence intervall (t)
plt.axvline(164.304164, 0, 1, linewidth=3, color='r');
plt.axvline(165.695836, 0, 1, linewidth=3, color='r');
</code></pre>

<p><img src="output_124_0.png" alt="png" /></p>

<hr />

<hr />

<h2 id="further-measures-for-model-selection">Further measures for model selection</h2>

<p>When fitting models, it is possible to increase the likelihood by adding parameters, but doing so may result in overfitting.</p>

<p>Both the Bayesian information criterion (<strong>BIC</strong>) (also called the Schwarz criterion SBC or SBIC) and Akaike information criterion (<strong>AIC</strong>) attempt to resolve this problem by introducing a penalty term for the number of parameters in the model; the penalty term is larger in BIC than in AIC.</p>

<p>Both measures are an estimator of the <strong>relative quality</strong> of statistical models for a given set of data. Hence, they are used to select the best performing model.</p>

<p>Here we cover AIC and BIC in the case of a linear model fit using least squares; however, these quantities can also be defined for more general types of models.</p>

<p>For both measures, lower values are better</p>

<h3 id="bayesian-information-criterion-bic">Bayesian information criterion (BIC)</h3>

<pre><code class="language-python"># BIC
lm.bic
</code></pre>

<pre><code>41.980585438104086
</code></pre>

<h3 id="akaike-information-criterion-aic">Akaike information criterion (AIC)</h3>

<pre><code class="language-python"># AIC
lm.aic
</code></pre>

<pre><code>39.989120890996105
</code></pre>

    </div>

    

<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/appliedstatistics/">AppliedStatistics</a>
  
</div>



    
      








  
  
    
  
  





  
  
  
    
  
  
  <div class="media author-card" itemscope itemtype="http://schema.org/Person">
    
      
      <img class="portrait mr-3" src="/authors/jan/avatar_hu1d623008f699678abc0368ff80db1811_316634_250x250_fill_q90_lanczos_center.jpg" itemprop="image" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title" itemprop="name"><a href="/">Jan Kirenz</a></h5>
      <h6 class="card-subtitle">Professor</h6>
      <p class="card-text" itemprop="description">I&rsquo;m a data scientist educator and consultant.</p>
      <ul class="network-icon" aria-hidden="true">
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="/contact" >
              <i class="fas fa-paper-plane"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://github.com/kirenz" target="_blank" rel="noopener">
              <i class="fab fa-github"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://www.xing.com/profile/Jan_Kirenz" target="_blank" rel="noopener">
              <i class="fab fa-xing"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://www.linkedin.com/in/jan-kirenz-01b301a5/" target="_blank" rel="noopener">
              <i class="fab fa-linkedin-in"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>



      
      
      <div class="article-widget">
        <div class="hr-light"></div>
        <h3>Related</h3>
        <ul>
          
          <li><a href="/post/2019-08-01-r-descriptive-statistics/">Deskriptive Statistik in R</a></li>
          
          <li><a href="/project/r-data-science-stats/">Essential books for Data Science &amp; Statistics with R</a></li>
          
        </ul>
      </div>
      
    

    

    


  </div>
</article>

      

    
    
    
    <script src="/js/mathjax-config.js"></script>
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/css.min.js"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/bash.min.js"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/js.min.js"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/markdown.min.js"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/html.min.js"></script>
        
      

      
      
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_CHTML-full" integrity="sha256-GhM+5JHb6QUzOQPXSJLEWP7R73CbkisjzK5Eyij4U9w=" crossorigin="anonymous" async></script>
      
    

    
    

    
    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.9ef1b53ee2bde6c7f33b150c6ba4d452.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    <a href="/license/">LICENSE: CC-BY-SA <br> <i class="fab fa-creative-commons fa-2x"></i><i class="fab fa-creative-commons-by fa-2x"></i><i class="fab fa-creative-commons-sa fa-2x"></i> </a><br>
  </p>
  

  <p class="powered-by">
    &copy; Jan Kirenz, 2019 &middot; 

    Made with the <a href="https://cran.r-project.org/" target="_blank" rel="noopener"><i class="fab fa-r-project"></i> </a><a href="https://github.com/rstudio/blogdown" target="_blank" rel="noopener">blogdown</a> package and the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>. Source code available at 
    <a href="https://github.com/rbind/apreshill" target="_blank" rel="noopener"><i class="fas fa-code-branch" style="color:#E13D3D"></i></a>

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
