<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.3.1">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Jan Kirenz">

  
  
  
    
  
  <meta name="description" content="Implementation of Lasso Regression in Python">

  
  <link rel="alternate" hreflang="en-us" href="/post/2019-08-12-python-lasso-regression-auto/">

  


  

  
  
  
  <meta name="theme-color" content="#E13D3D">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/paraiso-light.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/paraiso-light.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    

    

  

  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Arapey:400,400i|Karla:400,700|Roboto+Mono|Open Sans:300">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.4d7f9d5497b4f9e1fc569198bc871fed.css">

  
    
    
    
    
      
    
    
    
    <link rel="stylesheet" href="/css/academic.8eb4558559a8cb72cfe457c72f587a28.css">
  

  
  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-62543454-1', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  
  

  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/2019-08-12-python-lasso-regression-auto/">

  
  
  
  
    
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="Jan Kirenz">
  <meta property="og:url" content="/post/2019-08-12-python-lasso-regression-auto/">
  <meta property="og:title" content="Lasso Regression with Python | Jan Kirenz">
  <meta property="og:description" content="Implementation of Lasso Regression in Python"><meta property="og:image" content="/post/2019-08-12-python-lasso-regression-auto/featured.jpg">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2019-08-12T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2019-08-12T00:00:00&#43;00:00">
  

  

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
<script>
  window.addEventListener("load", function(){
    window.cookieconsent.initialise({
      "palette": {
        "popup": {
          "background": "#E13D3D",
          "text": "#ffffff"
        },
        "button": {
          "background": "#ffffff",
          "text": "#E13D3D"
        }
      },
      "theme": "classic",
      "content": {
        "message": "This website uses cookies to ensure you get the best experience on our website.",
        "dismiss": "Got it!",
        "link": "Learn more",
        "href": "https://cookies.insites.com"
      }
    })});
</script>



  





  <title>Lasso Regression with Python | Jan Kirenz</title>

</head>


<body id="top" data-spy="scroll" data-target="#TableOfContents" data-offset="71" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" role="textbox" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">Jan Kirenz</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/post"><span>Blog</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/teaching"><span>Teaching</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/projects"><span>Resources</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/contact"><span>About/Contact</span></a>
        </li>

        
        

      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article" itemscope itemtype="http://schema.org/Article">

  













<div class="article-header d-xl-none">
  <div class="featured-image" style="background-image: url('/post/2019-08-12-python-lasso-regression-auto/featured_hue76a1f1ce8c01e6382d5577465b6e9e2_44866_800x0_resize_q90_lanczos.jpg');"></div>
  <span class="article-header-caption">Lasso Regression</span>
</div>


<div class="container-fluid split-header d-none d-xl-block">
  <div class="row">
    <div class="col-6">
      <div class="split-header-content">
        <h1 itemprop="name">Lasso Regression with Python</h1>

        

        



<meta content="2019-08-12 00:00:00 &#43;0000 UTC" itemprop="datePublished">
<meta content="2019-08-12 00:00:00 &#43;0000 UTC" itemprop="dateModified">

<div class="article-metadata">

  
  
  
  
  <div>
    



  <span itemprop="author name" itemtype="http://schema.org/Person"><a href="/authors/jan/">Jan Kirenz</a></span>

  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    <time>Aug 12, 2019</time>
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    7 min read
  </span>
  

  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder"></i>
    <a href="/categories/python/">Python</a>, <a href="/categories/statistics/">Statistics</a>, <a href="/categories/regression/">Regression</a></span>
  

  

</div>


        















        
<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/post/2019-08-12-python-lasso-regression-auto/&amp;text=Lasso%20Regression%20with%20Python" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/post/2019-08-12-python-lasso-regression-auto/&amp;t=Lasso%20Regression%20with%20Python" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Lasso%20Regression%20with%20Python&amp;body=/post/2019-08-12-python-lasso-regression-auto/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/post/2019-08-12-python-lasso-regression-auto/&amp;title=Lasso%20Regression%20with%20Python" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Lasso%20Regression%20with%20Python%20/post/2019-08-12-python-lasso-regression-auto/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/post/2019-08-12-python-lasso-regression-auto/&amp;title=Lasso%20Regression%20with%20Python" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>


      </div>
    </div>
    <div class="col-6">
      <div class="split-header-image">
        <img src="/post/2019-08-12-python-lasso-regression-auto/featured_hue76a1f1ce8c01e6382d5577465b6e9e2_44866_680x500_fill_q90_lanczos_smart1.jpg" itemprop="image" alt="">
        <span class="article-header-caption">Lasso Regression</span>
      </div>
    </div>
  </div>
</div>

<div class="article-container d-xl-none">
  <h1 itemprop="name">Lasso Regression with Python</h1>

  

  



<meta content="2019-08-12 00:00:00 &#43;0000 UTC" itemprop="datePublished">
<meta content="2019-08-12 00:00:00 &#43;0000 UTC" itemprop="dateModified">

<div class="article-metadata">

  
  
  
  
  <div>
    



  <span itemprop="author name" itemtype="http://schema.org/Person"><a href="/authors/jan/">Jan Kirenz</a></span>

  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    <time>Aug 12, 2019</time>
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    7 min read
  </span>
  

  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder"></i>
    <a href="/categories/python/">Python</a>, <a href="/categories/statistics/">Statistics</a>, <a href="/categories/regression/">Regression</a></span>
  

  
    
<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/post/2019-08-12-python-lasso-regression-auto/&amp;text=Lasso%20Regression%20with%20Python" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/post/2019-08-12-python-lasso-regression-auto/&amp;t=Lasso%20Regression%20with%20Python" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Lasso%20Regression%20with%20Python&amp;body=/post/2019-08-12-python-lasso-regression-auto/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/post/2019-08-12-python-lasso-regression-auto/&amp;title=Lasso%20Regression%20with%20Python" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Lasso%20Regression%20with%20Python%20/post/2019-08-12-python-lasso-regression-auto/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/post/2019-08-12-python-lasso-regression-auto/&amp;title=Lasso%20Regression%20with%20Python" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>


  

</div>

  














</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      

<div id="TOC">
<ul>
<li><a href="#lasso-regression-basics"><span class="toc-section-number">1</span> Lasso Regression Basics</a></li>
<li><a href="#implementation-of-lasso-regression"><span class="toc-section-number">2</span> Implementation of Lasso regression</a><ul>
<li><a href="#standardization"><span class="toc-section-number">2.1</span> Standardization</a></li>
<li><a href="#split-data"><span class="toc-section-number">2.2</span> Split data</a></li>
<li><a href="#lasso-regression"><span class="toc-section-number">2.3</span> Lasso regression</a></li>
<li><a href="#lasso-with-different-lambdas"><span class="toc-section-number">2.4</span> Lasso with different lambdas</a></li>
<li><a href="#plot-values-as-a-function-of-lambda"><span class="toc-section-number">2.5</span> Plot values as a function of lambda</a></li>
<li><a href="#identify-best-lambda-and-coefficients"><span class="toc-section-number">2.6</span> Identify best lambda and coefficients</a></li>
<li><a href="#cross-validation"><span class="toc-section-number">2.7</span> Cross Validation</a></li>
<li><a href="#best-model"><span class="toc-section-number">2.8</span> Best Model</a></li>
</ul></li>
</ul>
</div>

<div id="lasso-regression-basics" class="section level1">
<h1><span class="header-section-number">1</span> Lasso Regression Basics</h1>
<p>Lasso performs a so called <code>L1 regularization</code> (a process of introducing additional information in order to prevent overfitting), i.e. adds penalty equivalent to absolute value of the magnitude of coefficients.</p>
<p>In particular, the minimization objective does not only include the residual sum of squares (RSS) - like in the OLS regression setting - but also the sum of the absolute value of coefficients.</p>
<p>The residual sum of squares (RSS) is calculated as follows:</p>
<p><span class="math display">\[ RSS = \sum_{i=1}^{n} (y_i - \hat{y_i})^2 \]</span></p>
<p>This formula can be stated as:</p>
<p><span class="math display">\[ RSS = \sum_{i=1}^{n} \bigg(y_i - \big( \beta_{0} + \sum_{j=1}^{p} \beta_{j} x_{ij} \big) \bigg)^2  \]</span></p>
<ul>
<li>n represents the number of distinct data points, or observations, in our sample.</li>
<li>p denotes the number of variables that are available in the dataset.</li>
<li>x_{ij} represents the value of the jth variable for the ith observation, where i = 1, 2, . . ., n and j = 1, 2, . . . , p.</li>
</ul>
<p>In the lasso regression, the minimization objective becomes:</p>
<p><span class="math display">\[ \sum_{i=1}^{n} \bigg(y_i - \big( \beta_{0} + \sum_{j=1}^{p} \beta_{j} x_{ij} \big) \bigg)^2 + \lambda \sum_{j=1}^{p} |\beta_j|   \]</span></p>
<p>which equals:</p>
<p><span class="math display">\[RSS + \lambda \sum_{j=1}^{p} |\beta_j|  \]</span></p>
<p><span class="math inline">\(\lambda\)</span> (lambda) provides a trade-off between balancing RSS and magnitude of coefficients.</p>
<p><span class="math inline">\(\lambda\)</span> can take various values:</p>
<ul>
<li><span class="math inline">\(\lambda\)</span> = 0: Same coefficients as simple linear regression</li>
<li><span class="math inline">\(\lambda\)</span> = ∞: All coefficients zero (same logic as before)</li>
<li>0 &lt; <span class="math inline">\(\lambda\)</span> &lt; ∞: coefficients between 0 and that of simple linear regression</li>
</ul>
<hr />
</div>
<div id="implementation-of-lasso-regression" class="section level1">
<h1><span class="header-section-number">2</span> Implementation of Lasso regression</h1>
<p>Python set up:</p>
<pre class="python"><code>import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
%matplotlib inline
plt.style.use(&#39;ggplot&#39;)
import warnings; warnings.simplefilter(&#39;ignore&#39;)</code></pre>
<p>This notebook involves the use of the Lasso regression on the “Auto” dataset. In particular, we only use observations 1 to 200 for our analysis. Furthermore, you can drop the <code>name</code> variable.</p>
<p>Import data:</p>
<pre class="python"><code>df = pd.read_csv(&quot;https://raw.githubusercontent.com/kirenz/datasets/master/Auto.csv&quot;)</code></pre>
<p>Tidying data:</p>
<pre class="python"><code>df = df.iloc[0:200]
df = df.drop([&#39;name&#39;], axis=1)
df.info()</code></pre>
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 200 entries, 0 to 199
Data columns (total 8 columns):
mpg             200 non-null float64
cylinders       200 non-null int64
displacement    200 non-null float64
horsepower      200 non-null object
weight          200 non-null int64
acceleration    200 non-null float64
year            200 non-null int64
origin          200 non-null int64
dtypes: float64(3), int64(4), object(1)
memory usage: 12.6+ KB</code></pre>
<pre class="python"><code>df[&#39;origin&#39;] = pd.Categorical(df[&#39;origin&#39;])
df[&#39;horsepower&#39;] = pd.to_numeric(df[&#39;horsepower&#39;], errors=&#39;coerce&#39;)
print(df.isnull().sum())</code></pre>
<pre><code>mpg             0
cylinders       0
displacement    0
horsepower      2
weight          0
acceleration    0
year            0
origin          0
dtype: int64</code></pre>
<pre class="python"><code># drop missing cases
df = df.dropna()</code></pre>
<p>We use scikit learn to fit a Lasso regression <a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Lasso.html">(see documentation)</a> and follow a number of steps (note that scikit-learn uses <span class="math inline">\(\alpha\)</span> instead of <span class="math inline">\(\lambda\)</span> in their notation):</p>
<div id="standardization" class="section level2">
<h2><span class="header-section-number">2.1</span> Standardization</h2>
<p><em>Standardize the features with the module: <code>from sklearn.preprocessing import StandardScaler</code></em></p>
<p>It is important to standardize the features by removing the mean and scaling to unit variance. The L1 (Lasso) and L2 (Ridge) regularizers of linear models assume that all features are centered around 0 and have variance in the same order. If a feature has a variance that is orders of magnitude larger that others, it might dominate the objective function and make the estimator unable to learn from other features correctly as expected.</p>
<pre class="python"><code>dfs = df.astype(&#39;int&#39;)</code></pre>
<pre class="python"><code>dfs.info()</code></pre>
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 198 entries, 0 to 199
Data columns (total 8 columns):
mpg             198 non-null int64
cylinders       198 non-null int64
displacement    198 non-null int64
horsepower      198 non-null int64
weight          198 non-null int64
acceleration    198 non-null int64
year            198 non-null int64
origin          198 non-null int64
dtypes: int64(8)
memory usage: 13.9 KB</code></pre>
<pre class="python"><code>dfs.columns</code></pre>
<pre><code>Index([&#39;mpg&#39;, &#39;cylinders&#39;, &#39;displacement&#39;, &#39;horsepower&#39;, &#39;weight&#39;,
       &#39;acceleration&#39;, &#39;year&#39;, &#39;origin&#39;],
      dtype=&#39;object&#39;)</code></pre>
<pre class="python"><code>from sklearn.preprocessing import StandardScaler

scaler = StandardScaler()
dfs[[&#39;cylinders&#39;, &#39;displacement&#39;, &#39;horsepower&#39;,
     &#39;weight&#39;, &#39;acceleration&#39;, &#39;year&#39;, &#39;origin&#39;]] = scaler.fit_transform(dfs[[&#39;cylinders&#39;,
                                                                              &#39;displacement&#39;,
                                                                              &#39;horsepower&#39;,
                                                                              &#39;weight&#39;,
                                                                              &#39;acceleration&#39;,
                                                                              &#39;year&#39;, &#39;origin&#39;]])</code></pre>
<pre class="python"><code>dfs.head(5)</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
mpg
</th>
<th>
cylinders
</th>
<th>
displacement
</th>
<th>
horsepower
</th>
<th>
weight
</th>
<th>
acceleration
</th>
<th>
year
</th>
<th>
origin
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
18
</td>
<td>
1.179744
</td>
<td>
0.726091
</td>
<td>
0.325216
</td>
<td>
0.346138
</td>
<td>
-0.955578
</td>
<td>
-1.516818
</td>
<td>
-0.629372
</td>
</tr>
<tr>
<th>
1
</th>
<td>
15
</td>
<td>
1.179744
</td>
<td>
1.100254
</td>
<td>
1.129264
</td>
<td>
0.548389
</td>
<td>
-1.305309
</td>
<td>
-1.516818
</td>
<td>
-0.629372
</td>
</tr>
<tr>
<th>
2
</th>
<td>
18
</td>
<td>
1.179744
</td>
<td>
0.821807
</td>
<td>
0.784672
</td>
<td>
0.273370
</td>
<td>
-1.305309
</td>
<td>
-1.516818
</td>
<td>
-0.629372
</td>
</tr>
<tr>
<th>
3
</th>
<td>
16
</td>
<td>
1.179744
</td>
<td>
0.699986
</td>
<td>
0.784672
</td>
<td>
0.270160
</td>
<td>
-0.955578
</td>
<td>
-1.516818
</td>
<td>
-0.629372
</td>
</tr>
<tr>
<th>
4
</th>
<td>
17
</td>
<td>
1.179744
</td>
<td>
0.682583
</td>
<td>
0.554944
</td>
<td>
0.287282
</td>
<td>
-1.655041
</td>
<td>
-1.516818
</td>
<td>
-0.629372
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="split-data" class="section level2">
<h2><span class="header-section-number">2.2</span> Split data</h2>
<p><strong>Split the data set</strong> into train and test sets (use <code>X_train</code>, <code>X_test</code>, <code>y_train</code>, <code>y_test</code>), with the first 75% of the data for training and the remaining for testing. (module: <code>from sklearn.model_selection import train_test_split</code>)</p>
<pre class="python"><code>X = dfs.drop([&#39;mpg&#39;], axis=1)
y = dfs[&#39;mpg&#39;]</code></pre>
<pre class="python"><code>from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=10)</code></pre>
</div>
<div id="lasso-regression" class="section level2">
<h2><span class="header-section-number">2.3</span> Lasso regression</h2>
<p>Apply <strong>Lasso regression</strong> on the training set with the regularization parameter <strong>lambda = 0.5</strong> (module: <code>from sklearn.linear_model import Lasso</code>) and print the <span class="math inline">\(R^2\)</span>-score for the training and test set. Comment on your findings.</p>
<pre class="python"><code>from sklearn.linear_model import Lasso

reg = Lasso(alpha=0.5)
reg.fit(X_train, y_train)</code></pre>
<p>Lasso(alpha=0.5, copy_X=True, fit_intercept=True, max_iter=1000,
normalize=False, positive=False, precompute=False, random_state=None,
selection=‘cyclic’, tol=0.0001, warm_start=False)</p>
<pre class="python"><code>print(&#39;Lasso Regression: R^2 score on training set&#39;, reg.score(X_train, y_train)*100)
print(&#39;Lasso Regression: R^2 score on test set&#39;, reg.score(X_test, y_test)*100)</code></pre>
<p>Lasso Regression: R^2 score on training set 82.49741060950073
Lasso Regression: R^2 score on test set 85.49734440925533</p>
</div>
<div id="lasso-with-different-lambdas" class="section level2">
<h2><span class="header-section-number">2.4</span> Lasso with different lambdas</h2>
<p>Apply the <strong>Lasso regression</strong> on the training set with the following <strong>λ parameters: (0.001, 0.01, 0.1, 0.5, 1, 2, 10)</strong>. Evaluate the R^2 score for all the models you obtain on both the train and test sets.</p>
<pre class="python"><code>lambdas = (0.001, 0.01, 0.1, 0.5, 1, 2, 10)
l_num = 7
pred_num = X.shape[1]

# prepare data for enumerate
coeff_a = np.zeros((l_num, pred_num))
train_r_squared = np.zeros(l_num)
test_r_squared = np.zeros(l_num)</code></pre>
<pre class="python"><code># enumerate through lambdas with index and i
for ind, i in enumerate(lambdas):    
    reg = Lasso(alpha = i)
    reg.fit(X_train, y_train)

    coeff_a[ind,:] = reg.coef_
    train_r_squared[ind] = reg.score(X_train, y_train)
    test_r_squared[ind] = reg.score(X_test, y_test)</code></pre>
</div>
<div id="plot-values-as-a-function-of-lambda" class="section level2">
<h2><span class="header-section-number">2.5</span> Plot values as a function of lambda</h2>
<p><strong>Plot</strong> all values for both data sets (train and test <span class="math inline">\(R^2\)</span>-values) as a function of λ. Comment on your findings.</p>
<pre class="python"><code># Plotting
plt.figure(figsize=(18, 8))
plt.plot(train_r_squared, &#39;bo-&#39;, label=r&#39;$R^2$ Training set&#39;, color=&quot;darkblue&quot;, alpha=0.6, linewidth=3)
plt.plot(test_r_squared, &#39;bo-&#39;, label=r&#39;$R^2$ Test set&#39;, color=&quot;darkred&quot;, alpha=0.6, linewidth=3)
plt.xlabel(&#39;Lamda index&#39;); plt.ylabel(r&#39;$R^2$&#39;)
plt.xlim(0, 6)
plt.title(r&#39;Evaluate lasso regression with lamdas: 0 = 0.001, 1= 0.01, 2 = 0.1, 3 = 0.5, 4= 1, 5= 2, 6 = 10&#39;)
plt.legend(loc=&#39;best&#39;)
plt.grid()</code></pre>
<p><img src="/post/2019-08-12-python-lasso-regression-auto/output_27_0.png" /></p>
</div>
<div id="identify-best-lambda-and-coefficients" class="section level2">
<h2><span class="header-section-number">2.6</span> Identify best lambda and coefficients</h2>
<p>Store your test data results in a DataFrame and indentify the lambda where the <span class="math inline">\(R^2\)</span> has it’s <strong>maximum value</strong> in the <strong>test data</strong>. Fit a Lasso model with this lambda parameter (use the training data) and obtain the corresponding <strong>regression coefficients</strong>. Furthermore, obtain the <strong>mean squared error</strong> for the test data of this model (module: <code>from sklearn.metrics import mean_squared_error</code>)</p>
<pre class="python"><code>df_lam = pd.DataFrame(test_r_squared*100, columns=[&#39;R_squared&#39;])
df_lam[&#39;lambda&#39;] = (lambdas)
# returns the index of the row where column has maximum value.
df_lam.loc[df_lam[&#39;R_squared&#39;].idxmax()]</code></pre>
<p>R_squared 88.105773
lambda 0.001000
Name: 0, dtype: float64</p>
<pre class="python"><code># Coefficients of best model
reg_best = Lasso(alpha = 0.1)
reg_best.fit(X_train, y_train)
reg_best.coef_</code></pre>
<p>array([-0.35554113, -1.13104696, -0.00596296, -3.31741775, -0. ,
0.37914648, 0.74902885])</p>
<pre class="python"><code>from sklearn.metrics import mean_squared_error
mean_squared_error(y_test, reg_best.predict(X_test))</code></pre>
<p>3.586249592807347</p>
</div>
<div id="cross-validation" class="section level2">
<h2><span class="header-section-number">2.7</span> Cross Validation</h2>
<p>Evaluate the performance of a <strong>Lasso regression</strong> for different regularization parameters λ using <strong>5-fold cross validation</strong> on the training set (module: <code>from sklearn.model_selection import cross_val_score</code>) and plot the cross-validation (CV) <span class="math inline">\(R^2\)</span> scores of the training and test data as a function of λ.</p>
<p>Use the following lambda parameters:
l_min = 0.05
l_max = 0.2
l_num = 20
lambdas = np.linspace(l_min,l_max, l_num)</p>
<pre class="python"><code>l_min = 0.05
l_max = 0.2
l_num = 20
lambdas = np.linspace(l_min,l_max, l_num)

train_r_squared = np.zeros(l_num)
test_r_squared = np.zeros(l_num)

pred_num = X.shape[1]
coeff_a = np.zeros((l_num, pred_num))</code></pre>
<pre class="python"><code>from sklearn.model_selection import cross_val_score

for ind, i in enumerate(lambdas):    
    reg = Lasso(alpha = i)
    reg.fit(X_train, y_train)
    results = cross_val_score(reg, X, y, cv=5, scoring=&quot;r2&quot;)

    train_r_squared[ind] = reg.score(X_train, y_train)    
    test_r_squared[ind] = reg.score(X_test, y_test)</code></pre>
<pre class="python"><code># Plotting
plt.figure(figsize=(18, 8))
plt.plot(train_r_squared, &#39;bo-&#39;, label=r&#39;$R^2$ Training set&#39;, color=&quot;darkblue&quot;, alpha=0.6, linewidth=3)
plt.plot(test_r_squared, &#39;bo-&#39;, label=r&#39;$R^2$ Test set&#39;, color=&quot;darkred&quot;, alpha=0.6, linewidth=3)
plt.xlabel(&#39;Lamda value&#39;); plt.ylabel(r&#39;$R^2$&#39;)
plt.xlim(0, 19)
plt.title(r&#39;Evaluate 5-fold cv with different lamdas&#39;)
plt.legend(loc=&#39;best&#39;)
plt.grid()</code></pre>
<p><img src="/post/2019-08-12-python-lasso-regression-auto/output_35_0.png" /></p>
</div>
<div id="best-model" class="section level2">
<h2><span class="header-section-number">2.8</span> Best Model</h2>
<p>Finally, store your test data results in a DataFrame and identify the lambda where the <span class="math inline">\(R^2\)</span> has it’s <strong>maximum value</strong> in the <strong>test data</strong>. Fit a Lasso model with this lambda parameter (use the training data) and obtain the corresponding <strong>regression coefficients</strong>. Furthermore, obtain the <strong>mean squared error</strong> for the test data of this model (module: <code>from sklearn.metrics import mean_squared_error</code>)</p>
<pre class="python"><code>df_lam = pd.DataFrame(test_r_squared*100, columns=[&#39;R_squared&#39;])
df_lam[&#39;lambda&#39;] = (lambdas)
# returns the index of the row where column has maximum value.
df_lam.loc[df_lam[&#39;R_squared&#39;].idxmax()]</code></pre>
<p>R_squared 87.897525
lambda 0.050000
Name: 0, dtype: float64</p>
<pre class="python"><code># Best Model
reg_best = Lasso(alpha = 0.144737)
reg_best.fit(X_train, y_train)</code></pre>
<p>Lasso(alpha=0.144737, copy_X=True, fit_intercept=True, max_iter=1000,
normalize=False, positive=False, precompute=False, random_state=None,
selection=‘cyclic’, tol=0.0001, warm_start=False)</p>
<pre class="python"><code>from sklearn.metrics import mean_squared_error

mean_squared_error(y_test, reg_best.predict(X_test))</code></pre>
<p>3.635187490993961</p>
<pre class="python"><code>reg_best.coef_</code></pre>
<p>array([-0.34136411, -1.18223273, -0. , -3.27132984, 0. ,
0.33262331, 0.71385488])</p>
</div>
</div>

    </div>

    

<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/statistics/">Statistics</a>
  
</div>



    
      








  
  
    
  
  





  
  
  
    
  
  
  <div class="media author-card" itemscope itemtype="http://schema.org/Person">
    
      
      <img class="portrait mr-3" src="/authors/jan/avatar_hueae13a71fe19f01939a18649b8290d14_147971_250x250_fill_q90_lanczos_center.jpg" itemprop="image" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title" itemprop="name"><a href="/">Jan Kirenz</a></h5>
      <h6 class="card-subtitle">Professor</h6>
      <p class="card-text" itemprop="description">I&rsquo;m a data scientist educator and consultant.</p>
      <ul class="network-icon" aria-hidden="true">
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="/contact" >
              <i class="fas fa-paper-plane"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://github.com/kirenz" target="_blank" rel="noopener">
              <i class="fab fa-github"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://www.xing.com/profile/Jan_Kirenz" target="_blank" rel="noopener">
              <i class="fab fa-xing"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://www.linkedin.com/in/jan-kirenz-01b301a5/" target="_blank" rel="noopener">
              <i class="fab fa-linkedin-in"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>



      
      
      <div class="article-widget">
        <div class="hr-light"></div>
        <h3>Related</h3>
        <ul>
          
          <li><a href="/project/r-correlation-tutorial/">Correlation Tutorial with R</a></li>
          
          <li><a href="/project/r-lasso-regression/">Lasso Regression with Python</a></li>
          
          <li><a href="/project/python-time-series/">Time Series Analysis with Python</a></li>
          
          <li><a href="/post/2019-08-01-r-descriptive-statistics/">Deskriptive Statistik in R</a></li>
          
          <li><a href="/project/python-linear-regression/">Linear Regression Tutorial with Python</a></li>
          
        </ul>
      </div>
      
    

    

    


  </div>
</article>

      

    
    
    
    <script src="/js/mathjax-config.js"></script>
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/css.min.js"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/bash.min.js"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/js.min.js"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/markdown.min.js"></script>
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/html.min.js"></script>
        
      

      
      
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_CHTML-full" integrity="sha256-GhM+5JHb6QUzOQPXSJLEWP7R73CbkisjzK5Eyij4U9w=" crossorigin="anonymous" async></script>
      
    

    
    

    
    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.3394a224b26ce58ff36f44c54743e0ab.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    <a href="/license/">LICENSE: CC-BY-SA <br> <i class="fab fa-creative-commons fa-2x"></i><i class="fab fa-creative-commons-by fa-2x"></i><i class="fab fa-creative-commons-sa fa-2x"></i> </a><br>
  </p>
  

  <p class="powered-by">
    © Jan Kirenz, 2020 &middot; 

    Made with the <a href="https://cran.r-project.org/" target="_blank" rel="noopener"><i class="fab fa-r-project"></i> </a><a href="https://github.com/rstudio/blogdown" target="_blank" rel="noopener">blogdown</a> package and the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>. 

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
